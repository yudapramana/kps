import{z as U,A as B,x as R,V as A,B as s,C as a,D as t,I as u,G as l,Q as M,R as L,P as K,S as E,aB as F,aj as I,U as r,ay as _,aF as O,a as w,K as h,J as i,F as k}from"./AuthUserStore-67h2FHdL.js";import{h as c,a as D,b as z}from"./helper-D4kaxrhs.js";import{u as G,a as J}from"./LoadingStore-CLdtPdNn.js";import{S as C}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{a as Q}from"./app-CZBZEz52.js";const W={class:"content-header"},q={class:"container-fluid"},X={class:"row mb-2"},Z={key:0,class:"col-sm-6"},tt={class:"content"},et={class:"container-fluid"},st={class:"row"},at={class:"col-lg-12"},nt={class:"d-flex justify-content-between mb-2"},ot={key:0},it={class:"btn-group"},lt=["value"],dt={key:0,class:"text-center"},rt={key:0,class:"time-label"},ct={class:"bg-primary badge badge-primary badge-sm"},ut={style:{"margin-bottom":"10px"}},mt={class:"timeline-item"},ht={class:"time"},pt=["onClick"],ft={class:"timeline-header",style:{"font-size":"smaller","line-height":"1 !important"}},vt={class:"time"},bt={class:"timeline-body",style:{"font-size":"small","line-height":"1 !important"}},_t={style:{"font-size":"smaller"}},gt={style:{"text-align":"right"}},yt={style:{"font-size":"smaller",width:"100%"}},xt=["href"],Yt={class:"bg-primary badge badge-primary badge-sm"},Mt=["onClick"],kt={key:2,class:"text-center"},Ct={key:1,class:"card"},St={class:"card-body"},Bt={class:"table-responsive overlay-wrapper"},Lt={key:0,class:"overlay"},wt={class:"table table-bordered",style:{"line-height":"1 !important"}},Dt={key:0},$t=["rowspan"],Tt={class:"text-center text-sm"},zt={class:"s text-sm"},Pt=["innerHTML"],Vt={class:"s text-right text-sm"},jt={class:"s text-sm"},Ht={class:"s text-sm"},Nt=["href"],Ut={class:"text-center"},Rt=["onClick"],At={class:"s text-sm",style:{"white-space":"pre"}},Kt={class:"s text-center text-sm"},Et=["onClick"],Ft={key:1},qt={__name:"ListReports",setup(It){const g=Q(),y=G(),P=U(),d=B({data:[]}),S=(f=1)=>{y.toggleLoading(),w.get(`/api/reports?monthyear=${p.value}&page=${f}`).then(e=>{d.value=e.data,y.toggleLoading()}).catch(e=>{e.response&&e.response.status===401?window.location.href="/login":console.error("Terjadi kesalahan:",e)})},$=(f,e)=>{C.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(m=>{m.isConfirmed&&w.delete(`/api/reports/${e}`).then(x=>{d.value.data[f].works=d.value.data[f].works.filter(v=>v.id!==e),C.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"})})})},T=(f,e)=>{C.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(m=>{m.isConfirmed&&w.delete(`/api/parent-reports/${e}`).then(x=>{d.value.data=d.value.data.filter(v=>v.id!==e),C.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"})})})},p=R("SettingStore:mySelected",B("")),V=B([{text:c().subtract(5,"months").format("MMMM  YYYY"),id:c().subtract(5,"months").format("YYYY-MM")},{text:c().subtract(4,"months").format("MMMM  YYYY"),id:c().subtract(4,"months").format("YYYY-MM")},{text:c().subtract(3,"months").format("MMMM  YYYY"),id:c().subtract(3,"months").format("YYYY-MM")},{text:c().subtract(2,"months").format("MMMM  YYYY"),id:c().subtract(2,"months").format("YYYY-MM")},{text:c().subtract(1,"months").format("MMMM  YYYY"),id:c().subtract(1,"months").format("YYYY-MM")},{text:c().format("MMMM  YYYY"),id:c().format("YYYY-MM")}]),j=()=>{S()},H=()=>{P.user.nama_pemeriksa?p.value?window.open("/print-lckb/"+p.value,"_blank"):alert("Pilih bulan dan tahun terlebih dahulu!"):alert("Nama dan NIP pemeriksa belum diisi!. Harap diisi di profil!")};return A(()=>{S()}),(f,e)=>{var x,v;const m=K("router-link");return a(),s(r,null,[t("div",W,[t("div",q,[t("div",X,[e[4]||(e[4]=t("div",{class:"col-sm-6"},[t("h1",{class:"m-0"},"Laporan Kerja")],-1)),l(g).isMobile?u("",!0):(a(),s("div",Z,e[3]||(e[3]=[t("ol",{class:"breadcrumb float-sm-right"},[t("li",{class:"breadcrumb-item"},[t("a",{href:"#"},"Home")]),t("li",{class:"breadcrumb-item active"},"Laporan Kerja")],-1)])))])])]),t("div",tt,[t("div",et,[t("div",st,[t("div",at,[t("div",nt,[l(g).isMobile?u("",!0):(a(),s("div",ot,[M(m,{to:"/admin/reports/create"},{default:L(()=>e[5]||(e[5]=[t("button",{class:"btn btn-primary"},[t("i",{class:"fa fa-plus-circle mr-1"}),h(" Tambah ")],-1)])),_:1})])),t("div",it,[t("button",{onClick:e[0]||(e[0]=o=>H()),class:"btn btn-secondary"},e[6]||(e[6]=[t("span",{class:"mr-1"},"Print",-1)])),E(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>I(p)?p.value=o:null),class:"custom-select rounded-0",onChange:e[2]||(e[2]=o=>j())},[(a(!0),s(r,null,_(V.value,o=>(a(),s("option",{value:o.id,key:o.id},i(o.text),9,lt))),128))],544),[[F,l(p)]])])]),l(g).isMobile?(a(),s("div",{key:0,class:"timeline",style:O(d.value.last_page==1?"margin-bottom: 100px":"")},[e[12]||(e[12]=t("hr",null,null,-1)),l(y).isLoading?(a(),s("div",dt,e[7]||(e[7]=[t("div",{class:"overlay"},[t("i",{class:"fas fa-3x fa-sync-alt fa-spin"}),t("div",{class:"text-bold pt-2"},"Loading...")],-1)]))):u("",!0),d.value.data.length>0?(a(!0),s(r,{key:1},_(d.value.data,(o,b)=>(a(),s(r,null,[o.works.length>0?(a(!0),s(r,{key:0},_(o.works,(n,Y)=>(a(),s(r,{key:n.id},[Y===0?(a(),s("div",rt,[t("span",ct,i(l(D)(o.date)),1)])):u("",!0),t("div",ut,[t("div",mt,[t("span",ht,[M(m,{to:`/admin/reports/${n.id}/edit`,class:"badge badge-info right",style:{"margin-right":"3px"}},{default:L(()=>e[8]||(e[8]=[h(" Ubah ")])),_:2},1032,["to"]),t("a",{href:"#",class:"badge badge-danger right",onClick:k(N=>$(b,n.id),["prevent"])}," Hapus ",8,pt)]),t("h3",ft,[t("span",vt,i(l(D)(o.date)),1)]),t("div",bt,[h(" ["+i(n.volume)+" "+i(n.unit)+"] "+i(n.work_name),1),e[10]||(e[10]=t("br",null,null,-1)),t("span",_t,i(n.work_detail),1),e[11]||(e[11]=t("br",null,null,-1)),t("div",gt,[t("span",yt,[e[9]||(e[9]=h(" Bukti Dukung ")),n.evidence_url?(a(),s("a",{key:0,target:"blank",href:n.evidence_url??"#"}," [ "+i(n.evidence)+" ]",9,xt)):(a(),s(r,{key:1},[h(" [ "+i(n.evidence)+" ] ",1)],64))])])])])])],64))),128)):(a(),s(r,{key:1},[(a(),s("div",{class:"time-label",key:o.id},[t("span",Yt,i(l(D)(o.date)),1),t("a",{class:"badge badge-danger",style:{"margin-left":"3px"},href:"#",onClick:k(n=>T(b,o.id),["prevent"])}," hapus ",8,Mt)])),(a(),s("div",{key:o.id}," .: Belum ada Data :. "))],64))],64))),256)):(a(),s("div",kt," .: Belum ada Data :. "))],4)):u("",!0),l(g).isMobile?u("",!0):(a(),s("div",Ct,[t("div",St,[t("div",Bt,[l(y).isLoading?(a(),s("div",Lt,e[13]||(e[13]=[t("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1),t("div",{class:"text-bold pt-2"},"Loading...",-1)]))):u("",!0),t("table",wt,[e[20]||(e[20]=t("thead",null,[t("tr",null,[t("th",{scope:"col text-sm"},"Tanggal"),t("th",{scope:"col text-sm",class:"text-center"},"#"),t("th",{scope:"col text-sm",width:"50%"},"Pekerjaan"),t("th",{scope:"col text-sm",class:"text-right"},"Vol"),t("th",{scope:"col text-sm"},"Unit"),t("th",{scope:"col text-sm"},"Eviden"),t("th",{scope:"col text-sm"},"Options")])],-1)),((x=d.value.data)==null?void 0:x.length)>0?(a(),s("tbody",Dt,[(a(!0),s(r,null,_(d.value.data,(o,b)=>(a(),s(r,null,[o.works.length>0?(a(!0),s(r,{key:0},_(o.works,(n,Y)=>(a(),s("tr",{key:n.id},[Y===0?(a(),s("td",{key:0,rowspan:o.works.length,class:"s text-sm",style:{"white-space":"pre"}},i(l(z)(o.date)),9,$t)):u("",!0),t("td",Tt,i(Y+1),1),t("td",zt,[h(i(n.work_name)+" ",1),e[14]||(e[14]=t("br",null,null,-1)),t("p",{class:"text-muted m-0 p-0",style:{"font-size":"smaller !important"},innerHTML:n.work_detail},null,8,Pt)]),t("td",Vt,i(n.volume),1),t("td",jt,i(n.unit),1),t("td",Ht,[n.evidence_url?(a(),s("a",{key:0,target:"blank",href:n.evidence_url??"#"},i(n.evidence),9,Nt)):(a(),s(r,{key:1},[h(i(n.evidence),1)],64))]),t("td",Ut,[M(m,{to:`/admin/reports/${n.id}/edit`},{default:L(()=>e[15]||(e[15]=[t("i",{class:"fa fa-edit"},null,-1)])),_:2},1032,["to"]),t("a",{href:"#",onClick:k(N=>$(b,n.id),["prevent"])},e[16]||(e[16]=[t("i",{class:"fa fa-trash text-danger ml-2"},null,-1)]),8,Rt)])]))),128)):(a(),s("tr",{key:o.id},[t("td",At,i(l(z)(o.date)),1),t("td",Kt,[t("a",{href:"#",onClick:k(n=>T(b,o.id),["prevent"])},e[17]||(e[17]=[t("i",{class:"fa fa-trash text-danger"},null,-1)]),8,Et)]),e[18]||(e[18]=t("td",{colspan:"7",class:"text-center text-sm"},"Belum ada data...",-1))]))],64))),256))])):u("",!0),((v=d.value.data)==null?void 0:v.length)===0?(a(),s("tbody",Ft,e[19]||(e[19]=[t("tr",null,[t("td",{colspan:"7",class:"text-center"},"Tidak ada hasil, silahkan pilih bulan... ")],-1)]))):u("",!0)])])])])),M(l(J),{data:d.value,onPaginationChangePage:S,limit:1,keepLength:!0,style:{"margin-bottom":"100px"}},null,8,["data"])])])])])],64)}}};export{qt as default};
