import{F as r,G as V,J as N,P as i,Q as n,R as t,W as D,Z as C,U as l,ah as p,av as M,a5 as v,aw as _,T as E,S as H,ap as U}from"./pinia-BDOwh8JO.js";import{_ as I,c as W,b as f}from"./app-qojnDOIY.js";import{S as y}from"./sweetalert2.esm.all-9Qm2jZ7z.js";const z={class:"content-header"},J={class:"container-fluid"},K={class:"d-flex justify-content-between align-items-center"},Q={key:0,class:"text-muted d-block"},Y={class:"content"},Z={class:"container-fluid"},O={class:"card"},X={class:"card-header"},tt={class:"d-flex align-items-center flex-wrap"},et=["value"],st={class:"d-flex flex-wrap align-items-center"},at=["onClick"],lt={class:"card-body table-responsive p-0"},ot={class:"table table-bordered table-hover text-sm mb-0"},it={key:0},nt={key:1},dt={class:"text-muted"},rt={class:"badge badge-info text-uppercase"},ut={class:"text-center"},mt={class:"btn-group btn-group-sm"},vt=["onClick"],ct=["onClick"],pt={class:"modal fade",id:"sessionModal"},_t={class:"modal-dialog modal-lg"},ft={class:"modal-content"},yt={class:"modal-header py-2"},bt={class:"modal-body"},gt={class:"row"},ht={class:"col-md-4"},xt=["value"],kt={class:"col-md-4"},wt={class:"col-md-4"},St={class:"form-group mt-2"},Ct=["value"],Mt={__name:"SessionList",setup(Tt){const x=y.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),q=W(),u=r(q.query.event_day_id||""),k=r([]),w=r([]),T=r([]),B=r(null),b=r(null),R=r([]),m=r(null),S=r(!1),g=r(!1),d=r({id:null,room_id:"",activity_id:"",start_time:"",end_time:""}),c=async()=>{var a,e;if(u.value){S.value=!0;try{const o=await f.get("/api/v1/sessions",{params:{event_day_id:u.value,room_id:m.value}});k.value=o.data.data.sessions,w.value=o.data.data.rooms,T.value=o.data.data.activities,B.value=o.data.data.event,b.value=o.data.data.event_day,R.value=o.data.data.event_days}catch(o){y.fire({icon:"error",title:"Gagal memuat session",text:((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.message)||"Terjadi kesalahan sistem"})}finally{S.value=!1}}},j=()=>{g.value=!1,d.value={room_id:"",activity_id:"",start_time:"",end_time:""},$("#sessionModal").modal("show")},A=a=>{g.value=!0,d.value={id:a.id,room_id:a.room_id,activity_id:a.activity_id,start_time:a.start_time,end_time:a.end_time},$("#sessionModal").modal("show")},G=async()=>{var a,e;try{g.value?(await f.put(`/api/v1/sessions/${d.value.id}`,d.value),x.fire({icon:"success",title:"Session berhasil diperbarui"})):(await f.post("/api/v1/sessions",{...d.value,event_day_id:u.value}),x.fire({icon:"success",title:"Session berhasil ditambahkan"})),$("#sessionModal").modal("hide"),c()}catch(o){y.fire({icon:"error",title:"Gagal menyimpan session",text:((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.message)||"Terjadi kesalahan sistem"})}},L=async a=>{var o,s;if((await y.fire({title:"Hapus session?",text:`Session ${a.start_time} - ${a.end_time} akan dihapus`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{await f.delete(`/api/v1/sessions/${a.id}`),x.fire({icon:"success",title:"Session berhasil dihapus"}),c()}catch(h){y.fire({icon:"error",title:"Gagal menghapus session",text:((s=(o=h.response)==null?void 0:o.data)==null?void 0:s.message)||"Terjadi kesalahan sistem"})}},P=a=>{m.value=m.value===a?null:a};return V(u,()=>{m.value=null,c()}),V(m,()=>{c()}),N(async()=>{if(!u.value){const a=await f.get("/api/v1/event-days",{params:{per_page:1}});a.data.data.data.length&&(u.value=a.data.data.data[0].id)}c()}),(a,e)=>{var o;return n(),i(v,null,[t("section",z,[t("div",J,[t("div",K,[t("div",null,[e[9]||(e[9]=t("h1",{class:"mb-1"},"Sessions",-1)),b.value?(n(),i("small",Q,[e[6]||(e[6]=C(" Event: ")),t("strong",null,l((o=B.value)==null?void 0:o.name),1),e[7]||(e[7]=t("br",null,null,-1)),e[8]||(e[8]=C(" Hari: ")),t("strong",null,l(b.value.label)+" ("+l(b.value.date)+")",1)])):D("",!0)]),t("button",{class:"btn btn-primary btn-sm",onClick:j}," + Tambah Session ")])])]),t("section",Y,[t("div",Z,[t("div",O,[t("div",X,[t("div",tt,[p(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),class:"form-control form-control-sm mr-3",style:{width:"220px"}},[(n(!0),i(v,null,_(R.value,s=>(n(),i("option",{key:s.id,value:s.id},l(s.label)+" ("+l(s.date)+") ",9,et))),128))],512),[[M,u.value]]),t("div",st,[t("span",{class:E(["badge mr-1 cursor-pointer",m.value?"badge-light":"badge-primary"]),onClick:e[1]||(e[1]=s=>m.value=null)}," Semua Ruangan ",2),(n(!0),i(v,null,_(w.value,s=>(n(),i("span",{key:s.id,class:E(["badge mr-1 cursor-pointer",m.value===s.id?"badge-primary":"badge-light"]),onClick:h=>P(s.id)},l(s.name),11,at))),128))])])]),t("div",lt,[t("table",ot,[e[15]||(e[15]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",{style:{width:"120px"}},"Waktu"),t("th",null,"Ruangan"),t("th",null,"Activity"),t("th",{style:{width:"120px"}},"Kategori"),t("th",{style:{width:"110px"},class:"text-center"},"Aksi")])],-1)),t("tbody",null,[S.value?(n(),i("tr",it,e[10]||(e[10]=[t("td",{colspan:"6",class:"text-center"},"Memuat data...",-1)]))):k.value.length===0?(n(),i("tr",nt,e[11]||(e[11]=[t("td",{colspan:"6",class:"text-center text-muted"}," Belum ada session. ",-1)]))):D("",!0),(n(!0),i(v,null,_(k.value,(s,h)=>(n(),i("tr",{key:s.id},[t("td",null,l(h+1),1),t("td",null,l(s.start_time)+" - "+l(s.end_time),1),t("td",null,l(s.room.name),1),t("td",null,[t("strong",null,l(s.activity.title),1),e[12]||(e[12]=t("br",null,null,-1)),t("small",dt,l(s.activity.code||"-"),1)]),t("td",null,[t("span",rt,l(s.activity.category),1)]),t("td",ut,[t("div",mt,[t("button",{class:"btn btn-warning",onClick:F=>A(s)},e[13]||(e[13]=[t("i",{class:"fas fa-edit"},null,-1)]),8,vt),t("button",{class:"btn btn-danger",onClick:F=>L(s)},e[14]||(e[14]=[t("i",{class:"fas fa-trash"},null,-1)]),8,ct)])])]))),128))])])])])]),t("div",pt,[t("div",_t,[t("div",ft,[t("div",yt,[t("h5",null,l(g.value?"Edit Session":"Tambah Session"),1),e[16]||(e[16]=t("button",{class:"close","data-dismiss":"modal"},"Ã—",-1))]),t("div",bt,[t("form",{onSubmit:H(G,["prevent"])},[t("div",gt,[t("div",ht,[e[18]||(e[18]=t("label",null,"Ruangan",-1)),p(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>d.value.room_id=s),class:"form-control form-control-sm",required:""},[e[17]||(e[17]=t("option",{value:""},"-- Pilih Ruangan --",-1)),(n(!0),i(v,null,_(w.value,s=>(n(),i("option",{key:s.id,value:s.id},l(s.name),9,xt))),128))],512),[[M,d.value.room_id]])]),t("div",kt,[e[19]||(e[19]=t("label",null,"Mulai",-1)),p(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>d.value.start_time=s),type:"time",class:"form-control form-control-sm",required:""},null,512),[[U,d.value.start_time]])]),t("div",wt,[e[20]||(e[20]=t("label",null,"Selesai",-1)),p(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>d.value.end_time=s),type:"time",class:"form-control form-control-sm",required:""},null,512),[[U,d.value.end_time]])])]),t("div",St,[e[22]||(e[22]=t("label",null,"Activity",-1)),p(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>d.value.activity_id=s),class:"form-control form-control-sm",required:""},[e[21]||(e[21]=t("option",{value:""},"-- Pilih Activity --",-1)),(n(!0),i(v,null,_(T.value,s=>(n(),i("option",{key:s.id,value:s.id}," ["+l(s.category)+"] "+l(s.title),9,Ct))),128))],512),[[M,d.value.activity_id]])]),e[23]||(e[23]=t("div",{class:"text-right"},[t("button",{class:"btn btn-primary btn-sm"},[t("i",{class:"fas fa-save mr-1"}),C(" Simpan ")])],-1))],32)])])])])])],64)}}},Vt=I(Mt,[["__scopeId","data-v-6b6f5a14"]]);export{Vt as default};
