import{z as W,y as S,A as p,O as y,V as z,B as f,C as g,D as e,I as E,K as i,S as v,aB as U,as as _,U as V,ay as L,J as m,H as C,F as H,a as x,aC as Y}from"./AuthUserStore-67h2FHdL.js";import{S as r}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{_ as q}from"./app-CZBZEz52.js";const O={class:"content-header"},Q={class:"container-fluid"},R={class:"d-flex justify-content-between align-items-center"},X=["disabled"],Z={key:0,class:"text-danger text-sm mt-2 mb-0"},ee={class:"content"},te={class:"container-fluid"},ae={class:"card"},se={class:"card-header"},le={class:"d-flex flex-wrap justify-content-between align-items-center w-100"},oe={class:"d-flex flex-wrap align-items-center"},ne={class:"d-flex align-items-center mt-2 mt-sm-0"},ie={class:"card-body table-responsive p-0"},re={class:"table table-bordered table-hover text-sm mb-0"},de={key:0},ue={key:1},me={class:"text-center"},ce={class:"text-xs text-muted"},ve={key:0,class:"badge badge-light border"},pe={class:"badge badge-light border"},fe={class:"text-center"},ge={class:"text-center"},be={class:"btn-group btn-group-sm"},_e=["onClick"],xe=["title","onClick"],ke=["onClick"],he={class:"card-footer clearfix py-2"},we={class:"d-flex justify-content-between align-items-center"},ye={class:"text-muted text-sm"},Ue={class:"pagination pagination-sm m-0"},Ce={class:"page-item disabled"},Me={class:"page-link"},Be={class:"modal fade",id:"judgeUserModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},De={class:"modal-dialog modal-lg",role:"document"},$e={class:"modal-content"},Ee={class:"modal-header"},Ne={class:"modal-title"},je={class:"modal-body"},Ae={class:"form-row"},Se={class:"form-group col-md-6"},Ve={class:"form-group col-md-6"},He={class:"form-row"},Te={class:"form-group col-md-6"},Ge={class:"form-group col-md-6"},Ie={class:"form-row"},Pe={class:"form-group col-md-4"},Fe={class:"form-group col-md-4"},Ke={class:"form-group col-md-4"},Je=["value"],We={class:"modal-footer"},ze=["disabled"],Le={__name:"EventJudgesUsers",setup(Ye){const T=W(),N=S(()=>T.eventData||null),d=S(()=>{var s;return((s=N.value)==null?void 0:s.id)||null}),M=p([]),k=p(""),h=p(10),B=p(!1),w=p({is_active:""}),n=p({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),G=s=>s+1+(n.value.current_page-1)*n.value.per_page,D=p(!1),l=p(j());function j(){return{id:null,name:"",username:"",email:"",password:"",is_active:!0,can_multiple_role:!0}}const I=()=>{l.value=j(),$("#judgeUserModal").modal("show")},P=s=>{l.value={id:s.id,name:s.name||"",username:s.username||"",email:s.email||"",password:"",is_active:!!s.is_active,can_multiple_role:!!s.can_multiple_role},$("#judgeUserModal").modal("show")},c=async(s=1)=>{if(d.value){B.value=!0;try{const o=(await x.get(`/api/v1/events/${d.value}/judges`,{params:{page:s,per_page:h.value,search:k.value,is_active:w.value.is_active}})).data;M.value=o.data||[],n.value={current_page:o.current_page,per_page:o.per_page,total:o.total,from:o.from,to:o.to,last_page:o.last_page}}catch(t){console.error(t),r.fire("Gagal","Gagal memuat data dewan hakim.","error")}finally{B.value=!1}}},F=async()=>{var t,o;if(!d.value)return;const s={name:l.value.name,username:l.value.username,email:l.value.email,is_active:!!l.value.is_active,can_multiple_role:!!l.value.can_multiple_role,password:l.value.password||null,event_id:d.value};if(!s.name||!s.username||!s.email){r.fire("Validasi","Nama, username, dan email wajib diisi.","warning");return}D.value=!0;try{l.value.id?(await x.put(`/api/v1/judges/${l.value.id}`,s),r.fire("Berhasil","Dewan hakim berhasil diperbarui.","success")):(await x.post(`/api/v1/events/${d.value}/judges`,s),r.fire("Berhasil","Dewan hakim berhasil ditambahkan.","success")),$("#judgeUserModal").modal("hide"),c(n.value.current_page||1)}catch(a){const u=((o=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:o.message)||"Gagal menyimpan data.";r.fire("Gagal",u,"error")}finally{D.value=!1}},K=async s=>{var a,u;const t=!s.is_active;if((await r.fire({title:t?"Aktifkan user?":"Nonaktifkan user?",text:`${s.name} (${s.username})`,icon:"question",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Batal"})).isConfirmed)try{await x.patch(`/api/v1/judges/${s.id}/toggle-active`,{is_active:t}),c(n.value.current_page||1)}catch(b){r.fire("Gagal",((u=(a=b==null?void 0:b.response)==null?void 0:a.data)==null?void 0:u.message)||"Gagal mengubah status.","error")}},J=async s=>{var o,a;if((await r.fire({title:"Hapus user?",text:`${s.name} (${s.username})`,icon:"warning",showCancelButton:!0,confirmButtonText:"Hapus",cancelButtonText:"Batal"})).isConfirmed)try{await x.delete(`/api/v1/judges/${s.id}`),r.fire("Berhasil","User berhasil dihapus.","success"),c(1)}catch(u){r.fire("Gagal",((a=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:a.message)||"Gagal menghapus user.","error")}},A=s=>{s<1||s>n.value.last_page||c(s)};return y(()=>k.value,Y(()=>c(1),400)),y(()=>h.value,()=>c(1)),y(()=>({...w.value}),()=>c(1)),y(()=>d.value,s=>{s&&c(1)}),z(()=>{d.value?c(1):r.fire("Event belum dipilih","Silakan pilih event melalui Portal Event terlebih dahulu.","info")}),(s,t)=>{var o;return g(),f(V,null,[e("section",O,[e("div",Q,[e("div",R,[t[12]||(t[12]=e("div",null,[e("h1",{class:"mb-1"},"Manajemen Dewan Hakim"),e("p",{class:"mb-0 text-muted text-sm"},[i(" Mengelola user khusus role "),e("strong",null,"DEWAN_HAKIM"),i(" pada event aktif. ")])],-1)),e("div",null,[e("button",{class:"btn btn-sm btn-primary",disabled:!d.value,onClick:I},t[11]||(t[11]=[e("i",{class:"fas fa-plus mr-1"},null,-1),i(" Tambah Dewan Hakim ")]),8,X)])]),d.value?E("",!0):(g(),f("p",Z,t[13]||(t[13]=[e("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),i(" Event belum dipilih. Silakan pilih event melalui Portal Event terlebih dahulu. ")])))])]),e("section",ee,[e("div",te,[e("div",ae,[e("div",se,[e("div",le,[e("div",oe,[t[16]||(t[16]=e("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>h.value=a),class:"form-control form-control-sm w-auto mr-2"},t[14]||(t[14]=[e("option",{value:10},"10",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1)]),512),[[U,h.value,void 0,{number:!0}]]),t[17]||(t[17]=e("label",{class:"mb-0 text-sm text-muted mr-3"},"Entri",-1)),t[18]||(t[18]=e("label",{class:"mb-0 mr-1 text-sm text-muted"},"Status",-1)),v(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>w.value.is_active=a),class:"form-control form-control-sm w-auto mr-2"},t[15]||(t[15]=[e("option",{value:""},"Semua",-1),e("option",{value:"1"},"Aktif",-1),e("option",{value:"0"},"Nonaktif",-1)]),512),[[U,w.value.is_active]])]),e("div",ne,[v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>k.value=a),type:"text",class:"form-control form-control-sm w-auto",style:{"min-width":"280px"},placeholder:"Cari nama / username / email..."},null,512),[[_,k.value]])])])]),e("div",ie,[e("table",re,[t[24]||(t[24]=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{style:{width:"50px"}},"#"),e("th",null,"Nama"),e("th",{style:{width:"200px"}},"Username"),e("th",{style:{width:"110px"},class:"text-center"},"Status"),e("th",{style:{width:"150px"},class:"text-center"},"Aksi")])],-1)),e("tbody",null,[B.value?(g(),f("tr",de,t[19]||(t[19]=[e("td",{colspan:"6",class:"text-center py-4"},"Memuat data dewan hakim...",-1)]))):M.value.length===0?(g(),f("tr",ue,t[20]||(t[20]=[e("td",{colspan:"6",class:"text-center py-4"},[i(" Belum ada user dewan hakim untuk event ini. "),e("br"),e("small",{class:"text-muted"},[i(" Klik "),e("strong",null,"Tambah Dewan Hakim"),i(" untuk menambahkan user. ")])],-1)]))):E("",!0),(g(!0),f(V,null,L(M.value,(a,u)=>(g(),f("tr",{key:a.id},[e("td",me,m(G(u)),1),e("td",null,[e("strong",null,m(a.name),1),e("div",ce,[t[21]||(t[21]=e("span",{class:"badge badge-light border mr-1"},"DEWAN_HAKIM",-1)),a.can_multiple_role?(g(),f("span",ve,"multi-role")):E("",!0)])]),e("td",null,[e("span",pe,m(a.username),1)]),e("td",fe,[e("span",{class:C(["badge",a.is_active?"badge-success":"badge-secondary"])},m(a.is_active?"Aktif":"Nonaktif"),3)]),e("td",ge,[e("div",be,[e("button",{class:"btn btn-outline-primary btn-xs",title:"Edit",onClick:b=>P(a)},t[22]||(t[22]=[e("i",{class:"fas fa-edit"},null,-1)]),8,_e),e("button",{class:"btn btn-outline-warning btn-xs",title:a.is_active?"Nonaktifkan":"Aktifkan",onClick:b=>K(a)},[e("i",{class:C(["fas",a.is_active?"fa-user-slash":"fa-user-check"])},null,2)],8,xe),e("button",{class:"btn btn-outline-danger btn-xs",title:"Hapus",onClick:b=>J(a)},t[23]||(t[23]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ke)])])]))),128))])])]),e("div",he,[e("div",we,[e("div",ye," Menampilkan "+m(n.value.from||0)+" - "+m(n.value.to||0)+" dari "+m(n.value.total||0)+" dewan hakim ",1),e("ul",Ue,[e("li",{class:C(["page-item",{disabled:n.value.current_page===1}])},[e("a",{href:"#",class:"page-link",onClick:t[3]||(t[3]=H(a=>A(n.value.current_page-1),["prevent"]))},"«")],2),e("li",Ce,[e("span",Me,"Halaman "+m(n.value.current_page)+" / "+m(n.value.last_page||1),1)]),e("li",{class:C(["page-item",{disabled:n.value.current_page===n.value.last_page}])},[e("a",{href:"#",class:"page-link",onClick:t[4]||(t[4]=H(a=>A(n.value.current_page+1),["prevent"]))},"»")],2)])])])])]),e("div",Be,[e("div",De,[e("div",$e,[e("div",Ee,[e("h5",Ne,m(l.value.id?"Edit Dewan Hakim":"Tambah Dewan Hakim"),1),t[25]||(t[25]=e("button",{type:"button",class:"close","data-dismiss":"modal"},[e("span",null,"×")],-1))]),e("div",je,[t[35]||(t[35]=e("div",{class:"alert alert-light border text-sm mb-3"},[i(" User yang dibuat lewat halaman ini otomatis diberi role "),e("strong",null,"DEWAN_HAKIM"),i(" dan diset ke "),e("strong",null,"event aktif"),i(". ")],-1)),e("div",Ae,[e("div",Se,[t[26]||(t[26]=e("label",{class:"text-sm text-muted mb-1"},"Nama",-1)),v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value.name=a),type:"text",class:"form-control form-control-sm",placeholder:"Nama lengkap"},null,512),[[_,l.value.name,void 0,{trim:!0}]])]),e("div",Ve,[t[27]||(t[27]=e("label",{class:"text-sm text-muted mb-1"},"Username",-1)),v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>l.value.username=a),type:"text",class:"form-control form-control-sm",placeholder:"Username unik"},null,512),[[_,l.value.username,void 0,{trim:!0}]])])]),e("div",He,[e("div",Te,[t[28]||(t[28]=e("label",{class:"text-sm text-muted mb-1"},"Email",-1)),v(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>l.value.email=a),type:"email",class:"form-control form-control-sm",placeholder:"email@domain"},null,512),[[_,l.value.email,void 0,{trim:!0}]])]),e("div",Ge,[t[29]||(t[29]=e("label",{class:"text-sm text-muted mb-1"},[i(" Password "),e("small",{class:"text-muted"},"(kosongkan jika tidak ingin mengubah)")],-1)),v(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>l.value.password=a),type:"password",class:"form-control form-control-sm",placeholder:"Password"},null,512),[[_,l.value.password]])])]),e("div",Ie,[e("div",Pe,[t[31]||(t[31]=e("label",{class:"text-sm text-muted mb-1"},"Status",-1)),v(e("select",{"onUpdate:modelValue":t[9]||(t[9]=a=>l.value.is_active=a),class:"form-control form-control-sm"},t[30]||(t[30]=[e("option",{value:!0},"Aktif",-1),e("option",{value:!1},"Nonaktif",-1)]),512),[[U,l.value.is_active]])]),e("div",Fe,[t[33]||(t[33]=e("label",{class:"text-sm text-muted mb-1"},"Multi-role",-1)),v(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>l.value.can_multiple_role=a),class:"form-control form-control-sm"},t[32]||(t[32]=[e("option",{value:!0},"Ya",-1),e("option",{value:!1},"Tidak",-1)]),512),[[U,l.value.can_multiple_role]])]),e("div",Ke,[t[34]||(t[34]=e("label",{class:"text-sm text-muted mb-1"},"Event",-1)),e("input",{class:"form-control form-control-sm",value:((o=N.value)==null?void 0:o.event_name)||"-",disabled:""},null,8,Je)])])]),e("div",We,[t[37]||(t[37]=e("button",{class:"btn btn-sm btn-secondary","data-dismiss":"modal"},"Tutup",-1)),e("button",{class:"btn btn-sm btn-primary",disabled:D.value||!d.value,onClick:F},t[36]||(t[36]=[e("i",{class:"fas fa-save mr-1"},null,-1),i(" Simpan ")]),8,ze)])])])])])],64)}}},Re=q(Le,[["__scopeId","data-v-fe34beb8"]]);export{Re as default};
