import{z as O,y as Q,A as v,O as w,V as R,B as l,C as n,D as e,I as j,K as P,S as p,aB as W,as as f,U as _,ay as h,J as i,H as M,F as J,a as g,aC as T}from"./AuthUserStore-67h2FHdL.js";import{S as b}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{_ as X}from"./app-CZBZEz52.js";const Y={class:"content-header"},Z={class:"container-fluid"},q={class:"d-flex justify-content-between align-items-center"},ee={class:"btn-group btn-group-sm"},te=["disabled"],se={key:0,class:"text-danger text-sm mt-2 mb-0"},ae={class:"content"},le={class:"container-fluid"},ne={class:"card"},oe={class:"card-header py-2"},ie={class:"d-flex flex-wrap justify-content-between align-items-center"},de={class:"d-flex align-items-center gap-2"},re={class:"card-body p-0 table-responsive"},ue={class:"table table-bordered table-hover text-sm mb-0"},ce={key:0},me={key:1},ve={class:"text-center"},pe={class:"text-xs text-muted"},_e=["value","onChange"],ge=["value"],fe={key:0},he={key:0,class:"fas fa-gavel mr-1"},be={key:1,class:"fas fa-user mr-1"},xe={key:2},ye={key:1,class:"text-muted text-xs"},ke={class:"text-center"},we={class:"text-center"},je=["onClick"],Me={class:"card-footer clearfix py-2"},Ce={class:"d-flex justify-content-between align-items-center"},$e={class:"text-muted text-sm"},Be={class:"pagination pagination-sm m-0"},Pe={class:"page-item disabled"},Se={class:"page-link"},Ve={class:"modal fade",id:"createPanelModal",tabindex:"-1"},Ae={class:"modal-dialog"},De={class:"modal-content"},Je={class:"modal-body"},Te={class:"form-group"},Ue={class:"form-group"},He={class:"form-group mb-0"},Le={class:"modal-footer"},Ne=["disabled"],Ee={class:"modal fade",id:"membersModal",tabindex:"-1"},Ie={class:"modal-dialog modal-lg"},Ke={class:"modal-content"},Fe={class:"modal-header"},Ge={class:"modal-title"},ze={class:"modal-body"},Oe={class:"form-group"},Qe={key:0,class:"border rounded mt-2 p-2",style:{"max-height":"200px",overflow:"auto"}},Re=["onClick"],We={key:0,class:"text-muted text-sm"},Xe={key:1,class:"table table-sm table-bordered"},Ye={class:"text-center"},Ze=["checked","onChange"],qe={class:"text-center"},et=["onClick"],tt={__name:"EventJudgePanelList",setup(st){const S=O(),c=Q(()=>{var s;return((s=S.eventData)==null?void 0:s.id)||null}),C=v([]),B=v(!1),V=v([]),x=v(25),y=v(""),U=async(s,t)=>{try{await g.put(`/api/v1/event-judge-panels/${s}/assign-location`,{event_location_id:t||null}),b.fire({toast:!0,position:"top-end",icon:"success",title:"Lokasi majelis disimpan",showConfirmButton:!1,timer:1500}),m()}catch{b.fire({toast:!0,position:"top-end",icon:"error",title:"Gagal menyimpan lokasi",showConfirmButton:!1,timer:1500})}},A=async()=>{if(!c.value)return;const s=await g.get(`/api/v1/events/${c.value}/locations`,{params:{simple:1}});V.value=s.data.data||s.data},d=v({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),D=s=>{s<1||s>d.value.last_page||m(s)},H=s=>s+1+(d.value.current_page-1)*d.value.per_page,m=async(s=1)=>{if(!c.value)return;B.value=!0;const t=await g.get(`/api/v1/events/${c.value}/judge-panels`,{params:{page:s,per_page:x.value,search:y.value}});C.value=t.data.data,d.value=t.data.meta,B.value=!1},u=v({name:"",code:"",notes:"",saving:!1,readonly:!0}),L=async()=>{u.value={name:"Majelis (otomatis)",code:`${S.eventData.event_key}-MJ-*`,notes:"",saving:!1,readonly:!0},$("#createPanelModal").modal("show")},N=async()=>{u.value.saving=!0;try{await g.post(`/api/v1/events/${c.value}/judge-panels`),$("#createPanelModal").modal("hide"),b.fire("Berhasil","Majelis hakim ditambahkan","success"),m()}catch{b.fire("Gagal","Gagal menambah majelis","error")}finally{u.value.saving=!1}},o=v({panelId:null,title:"",search:"",options:[],selected:[]}),E=async s=>{o.value={panelId:s.id,title:s.name,search:"",options:[],selected:[...s.judges]},$("#membersModal").modal("show")},I=async s=>!s||s.length<2?[]:(await g.get(`/api/v1/events/${c.value}/event-judges`,{params:{search:s}})).data;w(()=>o.value.search,T(async s=>{o.value.options=await I(s)},300));const K=s=>{o.value.selected.some(t=>t.event_judge_id===s.id)||o.value.selected.push({event_judge_id:s.id,full_name:s.full_name,is_chief:!1})},F=s=>{o.value.selected=o.value.selected.filter(t=>t.event_judge_id!==s)},G=s=>{o.value.selected=o.value.selected.map(t=>({...t,is_chief:t.event_judge_id===s}))},z=async()=>{await g.put(`/api/v1/event-judge-panels/${o.value.panelId}/members`,{judges:o.value.selected.map(s=>({event_judge_id:s.event_judge_id,is_chief:s.is_chief}))}),$("#membersModal").modal("hide"),b.fire("Berhasil","Anggota majelis disimpan","success"),m()};return w(x,()=>m(1)),w(()=>y.value,T(()=>m(1),400)),w(c,s=>{s&&(m(),A())}),R(()=>{m(),A()}),(s,t)=>(n(),l(_,null,[e("section",Y,[e("div",Z,[e("div",q,[t[8]||(t[8]=e("div",null,[e("h1",{class:"mb-1"},"Majelis Hakim Event "),e("p",{class:"mb-0 text-muted text-sm"},"Pengelolaan majelis hakim berdasarkan skema event")],-1)),e("div",ee,[e("button",{class:"btn btn-sm btn-primary",disabled:!c.value,onClick:L}," + Tambah Majelis ",8,te)])]),c.value?j("",!0):(n(),l("p",se,t[9]||(t[9]=[e("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),P(" Event belum dipilih. Silakan pilih event melalui Portal Event terlebih dahulu. ")])))])]),e("section",ae,[e("div",le,[e("div",ne,[e("div",oe,[e("div",ie,[e("div",de,[t[11]||(t[11]=e("span",{class:"text-xs text-muted"},"Tampil",-1)),p(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>x.value=a),class:"form-control form-control-sm w-auto"},t[10]||(t[10]=[e("option",{value:10},"10",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1)]),512),[[W,x.value,void 0,{number:!0}]]),t[12]||(t[12]=e("span",{class:"text-xs text-muted"},"data",-1))]),p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>y.value=a),type:"text",class:"form-control form-control-sm",style:{width:"220px"},placeholder:"Cari nama / kode majelis"},null,512),[[f,y.value]])])]),e("div",re,[e("table",ue,[t[17]||(t[17]=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{width:"50"},"#"),e("th",null,"Nama Majelis"),e("th",null,"Lokasi"),e("th",null,"Hakim"),e("th",{width:"80",class:"text-center"},"Status"),e("th",{width:"120",class:"text-center"},"Aksi")])],-1)),e("tbody",null,[B.value?(n(),l("tr",ce,t[13]||(t[13]=[e("td",{colspan:"5",class:"text-center py-4"},"Memuat data...",-1)]))):C.value.length===0?(n(),l("tr",me,t[14]||(t[14]=[e("td",{colspan:"5",class:"text-center py-4 text-muted"}," Belum ada majelis hakim. ",-1)]))):j("",!0),(n(!0),l(_,null,h(C.value,(a,k)=>(n(),l("tr",{key:a.id},[e("td",ve,i(H(k)),1),e("td",null,[e("strong",null,i(a.name),1),e("div",pe,i(a.code||"-"),1)]),e("td",null,[e("select",{class:"form-control form-control-sm",value:a.event_location_id,onChange:r=>U(a.id,r.target.value)},[t[15]||(t[15]=e("option",{value:""},"— Belum Ditentukan —",-1)),(n(!0),l(_,null,h(V.value,r=>(n(),l("option",{key:r.id,value:r.id},i(r.code?r.code+" - ":"")+i(r.name),9,ge))),128))],40,_e)]),e("td",null,[a.judges.length?(n(),l("div",fe,[(n(!0),l(_,null,h(a.judges,r=>(n(),l("div",{key:r.event_judge_id},[e("span",{class:M(["badge mr-1 mb-1",r.is_chief?"badge-warning":"badge-light border"])},[r.is_chief?(n(),l("i",he)):(n(),l("i",be)),P(" "+i(r.full_name)+" ",1),r.is_chief?(n(),l("span",xe,"(Ketua)")):j("",!0)],2)]))),128))])):(n(),l("span",ye," Belum ada hakim "))]),e("td",ke,[e("span",{class:M(["badge",a.is_active?"badge-success":"badge-secondary"])},i(a.is_active?"Aktif":"Nonaktif"),3)]),e("td",we,[e("button",{class:"btn btn-xs btn-outline-primary",title:"Kelola Anggota",onClick:r=>E(a)},t[16]||(t[16]=[e("i",{class:"fas fa-users-cog"},null,-1)]),8,je)])]))),128))])])]),e("div",Me,[e("div",Ce,[e("div",$e," Menampilkan "+i(d.value.from||0)+" - "+i(d.value.to||0)+" dari "+i(d.value.total||0)+" data ",1),e("ul",Be,[e("li",{class:M(["page-item",{disabled:d.value.current_page===1}])},[e("a",{href:"#",class:"page-link",onClick:t[2]||(t[2]=J(a=>D(d.value.current_page-1),["prevent"]))},"«")],2),e("li",Pe,[e("span",Se," Halaman "+i(d.value.current_page)+" / "+i(d.value.last_page||1),1)]),e("li",{class:M(["page-item",{disabled:d.value.current_page===d.value.last_page}])},[e("a",{href:"#",class:"page-link",onClick:t[3]||(t[3]=J(a=>D(d.value.current_page+1),["prevent"]))},"»")],2)])])])])]),e("div",Ve,[e("div",Ae,[e("div",De,[t[23]||(t[23]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Tambah Majelis Hakim"),e("button",{class:"close","data-dismiss":"modal"},"×")],-1)),e("div",Je,[e("div",Te,[t[18]||(t[18]=e("label",{class:"text-sm text-muted"},"Nama Majelis *",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>u.value.name=a),class:"form-control form-control-sm",placeholder:"Contoh: Majelis Tilawah Dewasa",readonly:""},null,512),[[f,u.value.name]])]),e("div",Ue,[t[19]||(t[19]=e("label",{class:"text-sm text-muted"},"Kode",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>u.value.code=a),class:"form-control form-control-sm",placeholder:"MJ-A (opsional)",readonly:""},null,512),[[f,u.value.code]])]),e("div",He,[t[20]||(t[20]=e("label",{class:"text-sm text-muted"},"Catatan",-1)),p(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=a=>u.value.notes=a),rows:"2",class:"form-control form-control-sm"},null,512),[[f,u.value.notes]])])]),e("div",Le,[t[22]||(t[22]=e("button",{class:"btn btn-sm btn-secondary","data-dismiss":"modal"}," Batal ",-1)),e("button",{class:"btn btn-sm btn-primary",disabled:u.value.saving,onClick:N},t[21]||(t[21]=[e("i",{class:"fas fa-save mr-1"},null,-1),P(" Simpan ")]),8,Ne)])])])]),e("div",Ee,[e("div",Ie,[e("div",Ke,[e("div",Fe,[e("h5",Ge," Anggota Majelis — "+i(o.value.title),1),t[24]||(t[24]=e("button",{class:"close","data-dismiss":"modal"},"×",-1))]),e("div",ze,[e("div",Oe,[t[25]||(t[25]=e("label",{class:"text-sm text-muted mb-1"},"Cari Hakim",-1)),p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>o.value.search=a),class:"form-control form-control-sm",placeholder:"Ketik nama..."},null,512),[[f,o.value.search]]),o.value.options.length?(n(),l("div",Qe,[(n(!0),l(_,null,h(o.value.options,a=>(n(),l("div",{key:a.id,class:"d-flex justify-content-between align-items-center py-1"},[e("span",null,i(a.full_name),1),e("button",{class:"btn btn-xs btn-outline-primary",onClick:k=>K(a)}," Tambah ",8,Re)]))),128))])):j("",!0)]),t[28]||(t[28]=e("hr",null,null,-1)),o.value.selected.length===0?(n(),l("div",We," Belum ada hakim. ")):(n(),l("table",Xe,[t[27]||(t[27]=e("thead",{class:"thead-light"},[e("tr",null,[e("th",null,"Dewan Hakim"),e("th",{width:"120",class:"text-center"},"Ketua"),e("th",{width:"80",class:"text-center"},"Aksi")])],-1)),e("tbody",null,[(n(!0),l(_,null,h(o.value.selected,a=>(n(),l("tr",{key:a.event_judge_id},[e("td",null,i(a.full_name),1),e("td",Ye,[e("input",{type:"radio",name:"chief",checked:a.is_chief,onChange:k=>G(a.event_judge_id)},null,40,Ze)]),e("td",qe,[e("button",{class:"btn btn-xs btn-outline-danger",onClick:k=>F(a.event_judge_id)},t[26]||(t[26]=[e("i",{class:"fas fa-times"},null,-1)]),8,et)])]))),128))])]))]),e("div",{class:"modal-footer"},[t[29]||(t[29]=e("button",{class:"btn btn-sm btn-secondary","data-dismiss":"modal"},"Tutup",-1)),e("button",{class:"btn btn-sm btn-primary",onClick:z}," Simpan ")])])])])])],64))}},ot=X(tt,[["__scopeId","data-v-dc43dac7"]]);export{ot as default};
