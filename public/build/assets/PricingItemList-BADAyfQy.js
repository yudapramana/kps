import{F as n,G as U,J as j,P as i,Q as l,R as t,ah as d,av as c,a5 as y,aw as P,W as E,U as r,S as L,ap as G,Z as q,T as D}from"./pinia-BDOwh8JO.js";import{b as p}from"./app-Cc4vFrcH.js";import{S as u}from"./sweetalert2.esm.all-9Qm2jZ7z.js";const N={class:"content"},F={class:"container-fluid"},H={class:"card"},I={class:"card-header"},K={class:"d-flex justify-content-between align-items-center w-100"},R={class:"d-flex"},W=["value"],z={class:"card-body table-responsive p-0"},A={class:"table table-bordered table-hover text-sm mb-0"},J={key:0},Q={key:1},Y={class:"text-center"},Z={class:"btn-group btn-group-sm"},O=["onClick"],X=["onClick"],tt={class:"modal fade",id:"pricingModal"},et={class:"modal-dialog"},at={class:"modal-content"},st={class:"modal-header py-2"},ot={class:"modal-body"},it={class:"form-group"},lt=["value"],rt={class:"form-group"},nt={class:"form-group"},dt={class:"form-group"},vt={__name:"PricingItemList",setup(ut){const _=u.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),h=n([]),k=n([]),w=n(!1),m=n(!1),v=n(""),g=n(""),o=n({id:null,participant_category_id:"",bird_type:"",workshop_count:0,price:0}),b=async()=>{var s,e;w.value=!0;try{const a=await p.get("/api/v1/pricing-items",{params:{participant_category_id:v.value,bird_type:g.value}});h.value=a.data.data}catch(a){u.fire({icon:"error",title:"Gagal memuat pricing",text:((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Terjadi kesalahan sistem"})}finally{w.value=!1}},B=async()=>{try{const s=await p.get("/api/v1/participant-categories");k.value=s.data.data.data}catch{u.fire({icon:"error",title:"Gagal memuat kategori peserta"})}},C=()=>{m.value=!1,o.value={id:null,participant_category_id:"",bird_type:"",workshop_count:0,price:0},$("#pricingModal").modal("show")},S=s=>{m.value=!0,o.value={id:s.id,participant_category_id:s.participant_category_id,bird_type:s.bird_type,workshop_count:s.workshop_count,price:s.price},$("#pricingModal").modal("show")},M=async()=>{var s,e;try{m.value?(await p.put(`/api/v1/pricing-items/${o.value.id}`,o.value),_.fire({icon:"success",title:"Pricing berhasil diperbarui"})):(await p.post("/api/v1/pricing-items",o.value),_.fire({icon:"success",title:"Pricing berhasil ditambahkan"})),$("#pricingModal").modal("hide"),b()}catch(a){u.fire({icon:"error",title:"Gagal menyimpan pricing",text:((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Terjadi kesalahan sistem"})}},T=async s=>{var a,f;if((await u.fire({title:"Hapus pricing?",text:`Pricing ${s.package_label} akan dihapus`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{await p.delete(`/api/v1/pricing-items/${s.id}`),_.fire({icon:"success",title:"Pricing berhasil dihapus"}),b()}catch(x){u.fire({icon:"error",title:"Gagal menghapus pricing",text:((f=(a=x.response)==null?void 0:a.data)==null?void 0:f.message)||"Terjadi kesalahan sistem"})}},V=s=>Number(s).toLocaleString("id-ID");return U([v,g],b),j(()=>{B(),b()}),(s,e)=>(l(),i(y,null,[t("section",{class:"content-header"},[t("div",{class:"container-fluid"},[t("div",{class:"d-flex justify-content-between align-items-center"},[e[6]||(e[6]=t("div",null,[t("h1",{class:"mb-1"},"Pricing"),t("p",{class:"mb-0 text-muted text-sm"}," Manajemen harga berdasarkan kategori peserta & paket ")],-1)),t("button",{class:"btn btn-primary btn-sm",onClick:C}," + Tambah Pricing ")])])]),t("section",N,[t("div",F,[t("div",H,[t("div",I,[t("div",K,[t("div",R,[d(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),class:"form-control form-control-sm mr-2"},[e[7]||(e[7]=t("option",{value:""},"Semua Kategori",-1)),(l(!0),i(y,null,P(k.value,a=>(l(),i("option",{key:a.id,value:a.id},r(a.name),9,W))),128))],512),[[c,v.value]]),d(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),class:"form-control form-control-sm"},e[8]||(e[8]=[t("option",{value:""},"Semua Bird",-1),t("option",{value:"early"},"Early",-1),t("option",{value:"late"},"Late",-1)]),512),[[c,g.value]])])])]),t("div",z,[t("table",A,[e[13]||(e[13]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",null,"Kategori Peserta"),t("th",{style:{width:"80px"}},"Bird"),t("th",null,"Paket"),t("th",{style:{width:"160px"}},"Harga"),t("th",{style:{width:"110px"},class:"text-center"},"Aksi")])],-1)),t("tbody",null,[w.value?(l(),i("tr",J,e[9]||(e[9]=[t("td",{colspan:"6",class:"text-center"},"Memuat data...",-1)]))):h.value.length===0?(l(),i("tr",Q,e[10]||(e[10]=[t("td",{colspan:"6",class:"text-center text-muted"}," Belum ada pricing. ",-1)]))):E("",!0),(l(!0),i(y,null,P(h.value,(a,f)=>(l(),i("tr",{key:a.id},[t("td",null,r(f+1),1),t("td",null,[t("strong",null,r(a.participant_category.name),1)]),t("td",null,[t("span",{class:D(["badge",a.bird_type==="early"?"badge-success":"badge-secondary"])},r(a.bird_type),3)]),t("td",null,r(a.package_label),1),t("td",null," Rp "+r(V(a.price)),1),t("td",Y,[t("div",Z,[t("button",{class:"btn btn-warning",onClick:x=>S(a)},e[11]||(e[11]=[t("i",{class:"fas fa-edit"},null,-1)]),8,O),t("button",{class:"btn btn-danger",onClick:x=>T(a)},e[12]||(e[12]=[t("i",{class:"fas fa-trash"},null,-1)]),8,X)])])]))),128))])])])])]),t("div",tt,[t("div",et,[t("div",at,[t("div",st,[t("h5",null,r(m.value?"Edit Pricing":"Tambah Pricing"),1),e[14]||(e[14]=t("button",{class:"close","data-dismiss":"modal"},"Ã—",-1))]),t("div",ot,[t("form",{onSubmit:L(M,["prevent"])},[t("div",it,[e[16]||(e[16]=t("label",null,"Kategori Peserta",-1)),d(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.participant_category_id=a),class:"form-control form-control-sm",required:""},[e[15]||(e[15]=t("option",{value:""},"-- Pilih --",-1)),(l(!0),i(y,null,P(k.value,a=>(l(),i("option",{key:a.id,value:a.id},r(a.name),9,lt))),128))],512),[[c,o.value.participant_category_id]])]),t("div",rt,[e[18]||(e[18]=t("label",null,"Bird Type",-1)),d(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.bird_type=a),class:"form-control form-control-sm",required:""},e[17]||(e[17]=[t("option",{value:""},"-- Pilih --",-1),t("option",{value:"early"},"Early",-1),t("option",{value:"late"},"Late",-1)]),512),[[c,o.value.bird_type]])]),t("div",nt,[e[20]||(e[20]=t("label",null,"Paket",-1)),d(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.workshop_count=a),class:"form-control form-control-sm",required:""},e[19]||(e[19]=[t("option",{value:0},"Symposium",-1),t("option",{value:1},"Symposium + 1 Workshop",-1),t("option",{value:2},"Symposium + 2 Workshop",-1)]),512),[[c,o.value.workshop_count,void 0,{number:!0}]])]),t("div",dt,[e[21]||(e[21]=t("label",null,"Harga (Rp)",-1)),d(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.price=a),type:"number",min:"0",class:"form-control form-control-sm",required:""},null,512),[[G,o.value.price,void 0,{number:!0}]])]),e[22]||(e[22]=t("div",{class:"text-right"},[t("button",{class:"btn btn-primary btn-sm"},[t("i",{class:"fas fa-save mr-1"}),q(" Simpan ")])],-1))],32)])])])])])],64))}};export{vt as default};
