import{A as i,y as u,a1 as F,z as W,V as G,ad as H,B as l,C as r,Q as U,D as e,R as P,_ as V,I as d,J as y,G as k,ax as J,F as $,S as w,as as A,az as O,H as X,aA as Y,L as Z,a as ee}from"./AuthUserStore-67h2FHdL.js";import{_ as te,u as ae}from"./app-CZBZEz52.js";const se={class:"mtq-login-page"},oe={key:0,class:"loading-overlay"},ne={class:"mtq-login-container"},le={class:"mtq-login-card"},re={class:"mtq-login-left d-none d-lg-flex"},ie={class:"mtq-login-poster-wrapper"},de=["src"],ce={class:"mtq-login-right"},ue={class:"mtq-login-header text-center mb-4"},pe={class:"mtq-login-logos mb-3"},me=["src"],ve=["src"],ge=["src"],_e=["src"],he={class:"mtq-login-title"},fe={class:"mtq-login-subtitle"},be={class:"mtq-login-tagline"},ye={class:"card mtq-login-form-card"},ke={class:"card-body login-card-body"},we={key:0,class:"alert alert-danger",role:"alert"},xe={class:"input-group mb-3"},qe={class:"input-group mb-3"},De=["type"],Se={class:"input-group-append"},Me={class:"input-group mb-3 align-items-center"},Le={class:"input-group-append"},Ce={class:"input-group-text p-0 bg-white"},Ee=["src"],Te={class:"row mb-3 align-items-center"},Ue={class:"col-8"},Pe={class:"icheck-primary"},Ve={class:"col-4 text-right"},Ae=["disabled"],Be={key:0},Ne={key:1},Qe={key:0,class:"mtq-event-warning"},Ie={__name:"Login",setup(Ke){const B=i(""),x=i("/captcha?"+Date.now()),q=()=>{B.value="",x.value="/captcha?"+Date.now()},N=u(()=>o.captcha&&o.captcha.length>=4),a=W(),Q=ae(),I=Z(),K=i(!1),R=u(()=>{var s,t;return(s=a.eventData)!=null&&s.poster_url?a.eventData.poster_url:(t=a.eventData)!=null&&t.logo_event?a.eventData.logo_event:"https://res.cloudinary.com/dezj1x6xp/image/upload/v1763442267/PandanViewMandeh/uaccfb20uvhpvjyafdoj.png"}),D=u(()=>{var s;return(s=a.eventData)!=null&&s.logo_event?a.eventData.logo_event:null}),S=u(()=>{var s;return(s=a.eventData)!=null&&s.logo_sponsor_1?a.eventData.logo_sponsor_1:null}),M=u(()=>{var s;return(s=a.eventData)!=null&&s.logo_sponsor_2?a.eventData.logo_sponsor_2:null}),L=u(()=>{var s;return(s=a.eventData)!=null&&s.logo_sponsor_3?a.eventData.logo_sponsor_3:null});G(()=>{window.addEventListener("pageshow",C)}),H(()=>{window.removeEventListener("pageshow",C)});const o=F({username:"",password:"",captcha:"",remember:!0}),h=i(!1),p=i(!1),m=i(""),j=i(""),C=s=>{},z=async()=>{var s,t,v,g,_,n,E,T;if(!a.selectedEventKey){m.value="Event belum dipilih. Silakan kembali ke halaman landing.";return}p.value=!0,m.value="";try{await ee.post("/login",{...o,event_key:a.selectedEventKey,"cf-turnstile-response":j.value}),await a.getAuthUser(),await Q.preloadMasterMTQ(),a.isAuthenticated=!0,a.activeLayout="admin",I.push("/admin/dashboard")}catch(f){console.error("Login error:",f);let b=((t=(s=f.response)==null?void 0:s.data)==null?void 0:t.message)||"Terjadi kesalahan saat login.";if(((v=f.response)==null?void 0:v.status)===422){const c=((_=(g=f.response)==null?void 0:g.data)==null?void 0:_.errors)||{};(n=c["cf-turnstile-response"])!=null&&n.length?b=c["cf-turnstile-response"][0]:(E=c.username)!=null&&E.length?b=c.username[0]:(T=c.password)!=null&&T.length&&(b=c.password[0])}m.value=b}finally{setTimeout(()=>p.value=!1,400)}};return(s,t)=>{var v,g,_;return r(),l("div",se,[U(V,{name:"fade"},{default:P(()=>[p.value?(r(),l("div",oe,t[5]||(t[5]=[e("div",{class:"spinner"},null,-1),e("p",null,"Memproses login...",-1)]))):d("",!0)]),_:1}),e("div",ne,[e("div",le,[e("div",re,[e("div",ie,[e("img",{src:R.value,alt:"Poster MTQ",class:"mtq-login-poster"},null,8,de)])]),e("div",ce,[e("div",ue,[e("div",pe,[D.value?(r(),l("img",{key:0,src:D.value,alt:"Logo Event",class:"mtq-login-logo-event"},null,8,me)):d("",!0),S.value?(r(),l("img",{key:1,src:S.value,alt:"Logo Event",class:"mtq-login-logo-small"},null,8,ve)):d("",!0),M.value?(r(),l("img",{key:2,src:M.value,alt:"Logo Event",class:"mtq-login-logo-small"},null,8,ge)):d("",!0),L.value?(r(),l("img",{key:3,src:L.value,alt:"Logo Event",class:"mtq-login-logo-small"},null,8,_e)):d("",!0)]),e("h1",he,y(((v=k(a).eventData)==null?void 0:v.app_name)||"e-MTQ"),1),e("p",fe,y(((g=k(a).eventData)==null?void 0:g.event_name)||"Portal MTQ Digital"),1),e("p",be,y(((_=k(a).eventData)==null?void 0:_.event_tagline)||"Pendaftaran peserta MTQ"),1)]),e("div",ye,[e("div",ke,[t[9]||(t[9]=e("p",{class:"login-box-msg"},"Silakan masuk untuk memulai sesi",-1)),U(V,{name:"fade"},{default:P(()=>[m.value?(r(),l("div",we,y(m.value),1)):d("",!0)]),_:1}),e("form",{onSubmit:$(z,["prevent"]),autocomplete:"off"},[e("div",xe,[w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>o.username=n),type:"text",class:"form-control",placeholder:"Username / NIP",required:"",autocomplete:"username"},null,512),[[A,o.username]]),t[6]||(t[6]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text mtq-input-icon"},[e("span",{class:"fas fa-user"})])],-1))]),e("div",qe,[w(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>o.password=n),type:h.value?"text":"password",class:"form-control",placeholder:"Password",required:"",autocomplete:"current-password"},null,8,De),[[O,o.password]]),e("div",Se,[e("button",{class:"input-group-text mtq-input-icon",type:"button",onClick:t[2]||(t[2]=n=>h.value=!h.value),tabindex:"-1"},[e("i",{class:X(h.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),e("div",Me,[w(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>o.captcha=n),type:"text",class:"form-control text-uppercase",placeholder:"Kode captcha",required:""},null,512),[[A,o.captcha]]),e("div",Le,[e("span",Ce,[e("img",{src:x.value,alt:"Captcha",class:"captcha-img",onClick:q,title:"Klik untuk refresh captcha"},null,8,Ee)])]),e("div",{class:"input-group-append"},[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:q,title:"Refresh captcha"},t[7]||(t[7]=[e("i",{class:"fas fa-sync-alt"},null,-1)]))])]),e("div",Te,[e("div",Ue,[e("div",Pe,[w(e("input",{type:"checkbox",id:"remember","onUpdate:modelValue":t[4]||(t[4]=n=>o.remember=n)},null,512),[[Y,o.remember]]),t[8]||(t[8]=e("label",{for:"remember"},"Â  Remember Me",-1))])]),e("div",Ve,[e("button",{type:"submit",class:"btn btn-success btn-block",disabled:p.value||!N.value},[p.value?(r(),l("span",Be,"Memuat...")):(r(),l("span",Ne,"MASUK"))],8,Ae)])])],32),t[10]||(t[10]=J('<div class="mtq-login-footer-links" data-v-d6518670><p class="mb-1" data-v-d6518670> Lupa Password? <a href="/password/wa/request" target="_blank" data-v-d6518670>Reset di sini</a></p><p class="mb-0" data-v-d6518670><a class="text-sm text-muted" href="https://wa.me/6282298476941?text=Assalamualaikum Wr Wb Admin Sigarda,%2C%20Saya%20Ingin%20Bertanya%20Tentang%20Sigarda,%20NIP%20Saya%20adalah:" target="_blank" data-v-d6518670> Tanya admin? </a></p></div>',1))])]),!K.value&&!k(a).eventData?(r(),l("p",Qe," Event tidak ditemukan atau belum dipilih. Silakan kembali ke halaman utama. ")):d("",!0)])])])])}}},ze=te(Ie,[["__scopeId","data-v-d6518670"]]);export{ze as default};
