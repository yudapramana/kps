import{A as B,a as N}from"./AuthUserStore-67h2FHdL.js";const K=["BRI","BNI","MANDIRI","BTN","BSI","BRI SYARIAH","BNI SYARIAH","MANDIRI SYARIAH","BCA","CIMB NIAGA","PERMATA","PANIN","OCBC NISP","DANAMON","MEGA","SINARMAS","BUKOPIN","MAYBANK","BTPN","J TRUST BANK","BANK DKI","BANK BJB","BANK BJB SYARIAH","BANK JATENG","BANK JATIM","BANK SUMUT","BANK NAGARI","BANK RIAU KEPRI","BANK SUMSEL BABEL","BANK LAMPUNG","BANK KALSEL","BANK KALBAR","BANK KALTIMTARA","BANK SULSEL BAR","BANK SULTRA","BANK SULUTGO","BANK NTB SYARIAH","BANK NTT","BANK PAPUA","BANK MALUKU MALUT"],w=a=>{if(!a)return"";const r=new Date(a);if(Number.isNaN(r.getTime()))return a;const l=String(r.getDate()).padStart(2,"0"),u=String(r.getMonth()+1).padStart(2,"0"),d=r.getFullYear();return`${l}-${u}-${d}`},T=a=>{if(!a)return"";const r=new Date(a);if(Number.isNaN(r.getTime()))return a;const l=String(r.getDate()).padStart(2,"0"),u=String(r.getMonth()+1).padStart(2,"0"),d=r.getFullYear(),p=String(r.getHours()).padStart(2,"0"),_=String(r.getMinutes()).padStart(2,"0");return`${l}-${u}-${d} ${p}:${_}`},R=a=>{switch(a){case"bank_data":return"badge-secondary";case"process":return"badge-info";case"verified":return"badge-success";case"need_revision":return"badge-warning";case"rejected":return"badge-danger";case"disqualified":return"badge-dark";default:return"badge-light"}},I=a=>{switch(a){case"bank_data":return"Bank Data";case"process":return"Diproses";case"verified":return"Terverifikasi";case"need_revision":return"Perlu Perbaikan";case"rejected":return"Ditolak";case"disqualified":return"Diskualifikasi";default:return a}},M=a=>{switch(a){case"not_yet":return"badge-secondary";case"verified":return"badge-success";case"rejected":return"badge-danger";default:return"badge-light"}},D=a=>{switch(a){case"not_yet":return"Belum Hadir";case"verified":return"Lolos Daftar Ulang";case"rejected":return"Tidak Lolos Daftar Ulang";default:return a}},F=a=>{const r=String(a||"").replace(/\D/g,"");if(r.length!==16)return null;const l=r.slice(6,8),u=r.slice(8,10),d=r.slice(10,12);let p=parseInt(l,10);const _=parseInt(u,10),e=parseInt(d,10);if(Number.isNaN(p)||Number.isNaN(_)||Number.isNaN(e))return null;let c="MALE";if(p>40&&(p-=40,c="FEMALE"),p<1||p>31||_<1||_>12)return null;const A=new Date().getFullYear()%100,v=e<=A?2e3+e:1900+e,b=String(v).padStart(4,"0"),g=String(_).padStart(2,"0"),o=String(p).padStart(2,"0");return{date:`${b}-${g}-${o}`,gender:c}},L=({form:a,provinceOptions:r,regencyOptions:l,districtOptions:u,villageOptions:d,isPrivileged:p,currentUser:_,eventInfo:e,isLoadingRegencies:c,isLoadingDistricts:s,isLoadingVillages:A})=>{const v=B(null),b=async()=>{if(!p.value){r.value=[];const n=_.value;n.province?(r.value=[n.province],a.value.participant.province_id||(a.value.participant.province_id=n.province.id)):n.province_id&&(r.value=[{id:n.province_id,name:"Provinsi Akun"}],a.value.participant.province_id||(a.value.participant.province_id=n.province_id));return}try{const n=await N.get("/api/v1/get/provinces");r.value=n.data.data||n.data||[]}catch(n){console.error("Gagal load provinsi:",n)}},g=async(n=!1)=>{if(!a.value.participant.province_id){l.value=[],u.value=[],d.value=[],n||(a.value.participant.regency_id="",a.value.participant.district_id="",a.value.participant.village_id=null);return}if(!p.value){l.value=[];const t=_.value;console.log("u"),console.log(_),t.regency?(l.value=[t.regency],a.value.participant.regency_id=t.regency.id):t.regency_id&&(l.value=[{id:t.regency_id,name:"Kab/Kota Akun"}],a.value.participant.regency_id=t.regency_id);return}c.value=!0,n||(l.value=[],a.value.participant.regency_id="",u.value=[],a.value.participant.district_id="",d.value=[],a.value.participant.village_id=null);try{const t=await N.get("/api/v1/get/regencies",{params:{province_id:a.value.participant.province_id}});l.value=t.data.data||t.data||[]}catch(t){console.error("Gagal load kab/kota:",t)}finally{c.value=!1}},o=async(n=!1)=>{if(!a.value.participant.regency_id){u.value=[],d.value=[],n||(a.value.participant.district_id="",a.value.participant.village_id=null);return}if(!p.value){u.value=[];const t=_.value;if(t.district)u.value=[t.district],a.value.participant.district_id=t.district.id;else if(t.district_id)u.value=[{id:t.district_id,name:"Kecamatan Akun"}],a.value.participant.district_id=t.district_id;else try{const i=await N.get("/api/v1/get/districts",{params:{regency_id:a.value.participant.regency_id}});u.value=i.data.data||i.data||[]}catch(i){console.error("Gagal load kecamatan:",i)}finally{s.value=!1}return}s.value=!0,n||(u.value=[],a.value.participant.district_id="",d.value=[],a.value.participant.village_id=null);try{const t=await N.get("/api/v1/get/districts",{params:{regency_id:a.value.participant.regency_id}});u.value=t.data.data||t.data||[]}catch(t){console.error("Gagal load kecamatan:",t)}finally{s.value=!1}},y=async(n=!1)=>{const t=a.value.participant.district_id;if(!t){d.value=[],n||(a.value.participant.village_id=null),v.value=null;return}if(!(v.value===t&&d.value.length)&&!(n&&v.value===t&&d.value.length)){A.value=!0,n||(d.value=[],a.value.participant.village_id=null);try{const i=await N.get("/api/v1/get/villages",{params:{district_id:t}});d.value=i.data.data||i.data||[],v.value=t}catch(i){console.error("Gagal load kel/desa:",i)}finally{A.value=!1}}};return{fetchProvinceOptions:b,fetchRegencyOptions:g,fetchDistrictOptions:o,fetchVillageOptions:y,applyEventRegionToForm:async(n=null)=>{if(!e.value)return;const t=e.value.event_level,i=n||{};if(t==="province"){e.value.province_id&&(a.value.participant.province_id=e.value.province_id,await g(!0)),i.regency_id&&(a.value.participant.regency_id=i.regency_id,await o(!0)),i.district_id&&(a.value.participant.district_id=i.district_id,await y(!0)),i.village_id&&(a.value.participant.village_id=i.village_id);return}if(t==="regency"){e.value.province_id&&(a.value.participant.province_id=e.value.province_id,await g(!0)),e.value.regency_id&&(a.value.participant.regency_id=e.value.regency_id,await o(!0)),i.district_id&&(a.value.participant.district_id=i.district_id,await y(!0)),i.village_id&&(a.value.participant.village_id=i.village_id);return}if(t==="district"){e.value.province_id&&(a.value.participant.province_id=e.value.province_id,await g(!0)),e.value.regency_id&&(a.value.participant.regency_id=e.value.regency_id,await o(!0)),e.value.district_id&&(a.value.participant.district_id=e.value.district_id,await y(!0)),i.village_id&&(a.value.participant.village_id=i.village_id);return}i.province_id&&(a.value.participant.province_id=i.province_id,await g(!0)),i.regency_id&&(a.value.participant.regency_id=i.regency_id,await o(!0)),i.district_id&&(a.value.participant.district_id=i.district_id,await y(!0)),i.village_id&&(a.value.participant.village_id=i.village_id)}}},P=(a=null)=>({participant:{id:null,nik:"",full_name:"",phone_number:"",place_of_birth:"",date_of_birth:"",gender:"",education:"SMA",address:"",province_id:null,regency_id:null,district_id:null,village_id:null,bank_account_number:"",bank_account_name:"",bank_name:"",photo_url:"",id_card_url:"",family_card_url:"",bank_book_url:"",certificate_url:"",other_url:"",tanggal_terbit_ktp:"",tanggal_terbit_kk:""},event_participant:{id:null,event_id:a,participant_id:null,event_category_id:"",contingent:"",registration_status:"bank_data",registration_notes:"",reregistration_status:"not_yet",reregistration_notes:""}}),U=["participant.nik","participant.full_name","participant.phone_number","participant.place_of_birth","participant.date_of_birth","participant.gender","participant.education","participant.address","participant.province_id","participant.regency_id","participant.district_id","participant.village_id","participant.bank_account_number","participant.bank_account_name","participant.bank_name","event_participant.event_category_id"],E=(a,r)=>r.split(".").reduce((l,u)=>l?l[u]:void 0,a),h=1024*1024,k=["photo_url","id_card_url","family_card_url","bank_book_url","certificate_url","other_url"],G=({files:a,fileErrors:r,form:l})=>({onFileChange:(e,c)=>{r.value[c]="";const s=e.target.files[0];if(!s){a.value[c]=null;return}if(c==="photo_url"){const A=["image/jpeg","image/jpg","image/png"],v=s.type;if(!A.includes(v)){r.value[c]="Foto harus berupa file JPG atau PNG.",e.target.value="",a.value[c]=null;return}}else if(s.type!=="application/pdf"){r.value[c]="Format file harus PDF.",e.target.value="",a.value[c]=null;return}if(s.size>h){r.value[c]="Ukuran file maksimal 1 MB.",e.target.value="",a.value[c]=null;return}a.value[c]=s},openFile:e=>{let c=a.value[e],s="";c?s=URL.createObjectURL(c):l.value.participant[e]&&(s=l.value.participant[e]),s&&window.open(s,"_blank")},hasFile:e=>!!a.value[e]||!!l.value.participant[e],resetFiles:()=>{k.forEach(e=>{a.value[e]=null,r.value[e]=""})}});export{L as a,K as b,P as c,G as d,U as e,R as f,E as g,k as h,M as i,D as j,T as k,w as l,F as p,I as r};
