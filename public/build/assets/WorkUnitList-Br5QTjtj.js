import{F as u,J as y,P as c,Q as m,as as T,R as e,U as f,S,ah as v,ap as g,av as W,a5 as h,aw as j,H as V}from"./pinia-BDOwh8JO.js";import{_ as $,b as r,$ as l}from"./app-qojnDOIY.js";import"./style-DE--g_Jd.js";const B={class:"content"},C={class:"container-fluid"},D={class:"d-flex gap-2"},H=["disabled"],E={class:"modal fade",id:"editModal",tabindex:"-1"},L={class:"modal-dialog"},N={class:"modal-content"},q={class:"modal-header"},A={class:"modal-title"},F={class:"modal-body"},J={class:"form-group"},P={class:"form-group"},R={class:"form-group"},I=["value"],K={__name:"WorkUnitList",setup(Q){const a=u({id:null,unit_name:"",unit_code:"",parent_unit:null}),d=u(!1),p=u([]),i=()=>{r.get("/api/work-units/tree").then(s=>{p.value=b(s.data);const t=_(s.data);k(t)})},b=(s,t=[])=>{var n;for(const o of s)t.push({id:o.id,unit_name:o.unit_name}),(n=o.children)!=null&&n.length&&b(o.children,t);return t},_=s=>s.flatMap(t=>{const n={id:t.id,parent:t.parent_unit??"#",text:t.unit_name,original:t,state:{opened:!0}},o=t.children?_(t.children):[];return[n,...o]}),k=s=>{V(()=>{const t=l("#tree-container");t.jstree(!0)&&t.jstree(!0).destroy(),t.jstree({core:{data:s,themes:{stripes:!0}}}),t.on("select_node.jstree",(n,o)=>{a.value={id:o.node.id,unit_name:o.node.original.original.unit_name,unit_code:o.node.original.original.unit_code,parent_unit:o.node.original.original.parent_unit},d.value=!0,l("#editModal").modal("show")})})},U=()=>{r.put(`/api/work-units/${a.value.id}`,a.value).then(()=>{l("#editModal").modal("hide"),i()})},w=()=>{r.post("/api/work-units",a.value).then(()=>{l("#editModal").modal("hide"),i()})},M=()=>{!a.value.id||!confirm("Hapus unit ini?")||r.delete(`/api/work-units/${a.value.id}`).then(()=>{a.value={id:null,unit_name:"",unit_code:"",parent_unit:null},i()})},x=()=>{a.value={id:null,unit_name:"",unit_code:"",parent_unit:null},d.value=!1,l("#editModal").modal("show")};return y(i),(s,t)=>(m(),c(h,null,[t[12]||(t[12]=T('<div class="content-header" data-v-6d3e3c92><div class="container-fluid" data-v-6d3e3c92><div class="row mb-2" data-v-6d3e3c92><div class="col-sm-6" data-v-6d3e3c92><h1 class="m-0" data-v-6d3e3c92>Satuan Kerja</h1></div><div class="col-sm-6" data-v-6d3e3c92><ol class="breadcrumb float-sm-right" data-v-6d3e3c92><li class="breadcrumb-item" data-v-6d3e3c92><a href="#" data-v-6d3e3c92>Home</a></li><li class="breadcrumb-item active" data-v-6d3e3c92>Daftar Satker</li></ol></div></div></div></div>',1)),e("div",B,[e("div",C,[e("div",{class:"d-flex justify-content-between align-items-center mb-3"},[t[4]||(t[4]=e("h5",null,"Work Unit Tree",-1)),e("button",{class:"btn btn-sm btn-primary",onClick:i},"Refresh")]),t[11]||(t[11]=e("div",{id:"tree-container",class:"mb-3"},null,-1)),e("div",D,[e("button",{class:"btn btn-sm btn-success",onClick:x},"Tambah Unit"),e("button",{class:"btn btn-sm btn-danger",onClick:M,disabled:!a.value.id},"Hapus Unit",8,H)]),e("div",E,[e("div",L,[e("div",N,[e("div",q,[e("h5",A,f(d.value?"Edit":"Tambah")+" Work Unit",1),t[5]||(t[5]=e("button",{type:"button",class:"close","data-dismiss":"modal"},"Ã—",-1))]),e("form",{onSubmit:t[3]||(t[3]=S(n=>d.value?U():w(),["prevent"]))},[e("div",F,[e("div",J,[t[6]||(t[6]=e("label",null,"Unit Name",-1)),v(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>a.value.unit_name=n),class:"form-control form-control-sm",required:""},null,512),[[g,a.value.unit_name]])]),e("div",P,[t[7]||(t[7]=e("label",null,"Unit Code",-1)),v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>a.value.unit_code=n),class:"form-control form-control-sm",required:""},null,512),[[g,a.value.unit_code]])]),e("div",R,[t[9]||(t[9]=e("label",null,"Parent Unit",-1)),v(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>a.value.parent_unit=n),class:"form-control form-control-sm"},[t[8]||(t[8]=e("option",{value:null},"-- Tidak Ada --",-1)),(m(!0),c(h,null,j(p.value,n=>(m(),c("option",{key:n.id,value:n.id},f(n.unit_name),9,I))),128))],512),[[W,a.value.parent_unit]])])]),t[10]||(t[10]=e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary btn-sm","data-dismiss":"modal"},"Batal"),e("button",{type:"submit",class:"btn btn-primary btn-sm"},"Simpan")],-1))],32)])])])])])],64))}},X=$(K,[["__scopeId","data-v-6d3e3c92"]]);export{X as default};
