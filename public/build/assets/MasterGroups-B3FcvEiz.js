import{A as d,O as B,V as A,B as r,C as i,D as a,S as u,aB as c,as as k,I as j,K as w,U as h,ay as M,J as n,H as C,F as G,a as m,aC as q}from"./AuthUserStore-67h2FHdL.js";import{S as v}from"./sweetalert2.esm.all-9Qm2jZ7z.js";const I={class:"content"},P={class:"container-fluid"},Y={class:"card"},z={class:"card-header"},J={class:"d-flex flex-wrap justify-content-between align-items-center w-100"},K={class:"d-flex align-items-center"},L={class:"card-body table-responsive p-0"},O={class:"table table-bordered table-hover text-sm mb-0"},Q={key:0},R={key:1},W={class:"text-center"},X={class:"text-center"},Z={class:"text-center"},aa={class:"text-center"},ta={class:"btn-group btn-group-sm"},ea=["onClick"],sa=["onClick"],la={class:"card-footer d-flex justify-content-between align-items-center py-2"},oa={class:"text-muted text-sm"},na={class:"pagination pagination-sm m-0"},ra={class:"page-item disabled"},ia={class:"page-link"},da={class:"modal fade",id:"masterGroupModal",tabindex:"-1"},ua={class:"modal-dialog modal-lg"},ma={class:"modal-content"},pa={class:"modal-header py-2"},ca={class:"modal-title"},va={class:"modal-body"},ga={class:"row"},ba={class:"col-md-6"},_a={class:"form-group mb-2"},fa=["value"],ha={class:"form-group mb-2"},xa=["value"],ya={class:"form-group mb-2"},ka={class:"col-md-6"},wa={class:"form-group mb-2"},Ma={class:"form-group mb-2"},Ca={class:"form-group mb-2"},Ga={class:"text-right mt-3"},Ta=["disabled"],Ua={key:0,class:"fas fa-spinner fa-spin mr-1"},Ba={key:1,class:"fas fa-save mr-1"},Da={__name:"MasterGroups",setup(Va){const x=d([]),T=d([]),U=d([]),g=d(""),b=d(10),_=d(!1),f=d(!1),y=d(!1),l=d({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),o=d({id:null,branch_id:"",group_id:"",max_age:0,is_team:!1,order_number:null,is_active:!0}),V=async()=>{const s=await m.get("/api/v1/branches?simple=1");T.value=s.data.data||[];const t=await m.get("/api/v1/groups?simple=1");U.value=t.data.data||[]},p=async(s=1)=>{y.value=!0;try{const e=(await m.get("/api/v1/master-groups",{params:{page:s,per_page:b.value,search:g.value}})).data.data;x.value=e.data||[],l.value=e}catch(t){console.error(t)}finally{y.value=!1}},S=()=>{_.value=!1,o.value={id:null,branch_id:"",group_id:"",max_age:0,is_team:!1,order_number:(l.value.total||0)+1,is_active:!0},$("#masterGroupModal").modal("show")},D=s=>{_.value=!0,o.value={id:s.id,branch_id:s.branch_id,group_id:s.group_id,max_age:s.max_age,is_team:!!s.is_team,order_number:s.order_number,is_active:!!s.is_active},$("#masterGroupModal").modal("show")},E=async()=>{f.value=!0;const s={...o.value};try{_.value?await m.put(`/api/v1/master-groups/${o.value.id}`,s):await m.post("/api/v1/master-groups",s),$("#masterGroupModal").modal("hide"),p(l.value.current_page),v.fire("Berhasil","Data berhasil disimpan","success")}catch(t){console.error(t),v.fire("Gagal","Tidak dapat menyimpan data","error")}finally{f.value=!1}},F=async s=>{if((await v.fire({title:"Hapus Data?",text:`Hapus master group: ${s.full_name}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{await m.delete(`/api/v1/master-groups/${s.id}`),p(l.value.current_page),v.fire("Berhasil","Data berhasil dihapus","success")}catch{v.fire("Gagal","Tidak dapat menghapus data","error")}};return B(()=>g.value,q(()=>p(1),400)),B(()=>b.value,()=>p(1)),A(()=>{V(),p()}),(s,t)=>(i(),r(h,null,[a("section",{class:"content-header"},[a("div",{class:"container-fluid"},[a("div",{class:"d-flex justify-content-between align-items-center"},[t[10]||(t[10]=a("div",null,[a("h1",{class:"mb-1"},"Master Golongan Cabang (Master Groups)"),a("p",{class:"mb-0 text-muted text-sm"}," Digunakan untuk membuat kombinasi Cabang + Golongan sebagai template event MTQ. Contoh: Hafalan Al Qur'an - 10 Juz. ")],-1)),a("button",{class:"btn btn-primary btn-sm",onClick:S}," + Tambah Master Group ")])])]),a("section",I,[a("div",P,[a("div",Y,[a("div",z,[a("div",J,[a("div",K,[t[12]||(t[12]=a("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),u(a("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),class:"form-control form-control-sm w-auto mr-2"},t[11]||(t[11]=[a("option",{value:10},"10",-1),a("option",{value:25},"25",-1),a("option",{value:50},"50",-1),a("option",{value:100},"100",-1)]),512),[[c,b.value,void 0,{number:!0}]]),t[13]||(t[13]=a("label",{class:"mb-0 text-sm text-muted"},"Entri",-1))]),u(a("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),type:"text",class:"form-control form-control-sm w-auto",placeholder:"Cari cabang / golongan...",style:{"min-width":"220px"}},null,512),[[k,g.value]])])]),a("div",L,[a("table",O,[t[18]||(t[18]=a("thead",{class:"thead-light"},[a("tr",null,[a("th",{width:"40"},"#"),a("th",null,"Cabang"),a("th",null,"Golongan"),a("th",null,"Full Name"),a("th",{width:"80",class:"text-center"},"Max Usia"),a("th",{width:"70",class:"text-center"},"Tim?"),a("th",{width:"80",class:"text-center"},"Urutan"),a("th",{width:"100",class:"text-center"},"Aksi")])],-1)),a("tbody",null,[y.value?(i(),r("tr",Q,t[14]||(t[14]=[a("td",{colspan:"8",class:"text-center"},"Memuat data...",-1)]))):x.value.length===0?(i(),r("tr",R,t[15]||(t[15]=[a("td",{colspan:"8",class:"text-center"},[w(" Belum ada master group. "),a("br"),a("small",{class:"text-muted"},"Klik Tambah Master Group untuk membuat template.")],-1)]))):j("",!0),(i(!0),r(h,null,M(x.value,(e,H)=>(i(),r("tr",{key:e.id},[a("td",null,n(H+1+(l.value.current_page-1)*l.value.per_page),1),a("td",null,n(e.branch_name),1),a("td",null,n(e.group_name),1),a("td",null,[a("strong",null,n(e.full_name),1)]),a("td",W,n(e.max_age),1),a("td",X,[a("span",{class:C(["badge",e.is_team?"badge-success":"badge-secondary"])},n(e.is_team?"Ya":"Tidak"),3)]),a("td",Z,n(e.order_number||"-"),1),a("td",aa,[a("div",ta,[a("button",{class:"btn btn-warning",onClick:N=>D(e)},t[16]||(t[16]=[a("i",{class:"fas fa-edit"},null,-1)]),8,ea),a("button",{class:"btn btn-danger",onClick:N=>F(e)},t[17]||(t[17]=[a("i",{class:"fas fa-trash"},null,-1)]),8,sa)])])]))),128))])])]),a("div",la,[a("div",oa," Menampilkan "+n(l.value.from)+" - "+n(l.value.to)+" dari "+n(l.value.total)+" data ",1),a("ul",na,[a("li",{class:C(["page-item",{disabled:l.value.current_page===1}])},[a("a",{href:"#",class:"page-link",onClick:t[2]||(t[2]=G(e=>s.changePage(l.value.current_page-1),["prevent"]))},"«")],2),a("li",ra,[a("span",ia,"Halaman "+n(l.value.current_page)+" / "+n(l.value.last_page),1)]),a("li",{class:C(["page-item",{disabled:l.value.current_page===l.value.last_page}])},[a("a",{href:"#",class:"page-link",onClick:t[3]||(t[3]=G(e=>s.changePage(l.value.current_page+1),["prevent"]))},"»")],2)])])])]),a("div",da,[a("div",ua,[a("div",ma,[a("div",pa,[a("h5",ca,[t[19]||(t[19]=a("i",{class:"fas fa-layer-group mr-1"},null,-1)),w(" "+n(_.value?"Edit Master Group":"Tambah Master Group"),1)]),t[20]||(t[20]=a("button",{class:"close","data-dismiss":"modal"},[a("span",null,"×")],-1))]),a("div",va,[a("form",{onSubmit:G(E,["prevent"])},[a("div",ga,[a("div",ba,[a("div",_a,[t[22]||(t[22]=a("label",null,"Cabang",-1)),u(a("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.value.branch_id=e),class:"form-control form-control-sm",required:""},[t[21]||(t[21]=a("option",{disabled:"",value:""},"-- pilih cabang --",-1)),(i(!0),r(h,null,M(T.value,e=>(i(),r("option",{value:e.id},n(e.name),9,fa))),256))],512),[[c,o.value.branch_id]])]),a("div",ha,[t[24]||(t[24]=a("label",null,"Golongan",-1)),u(a("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>o.value.group_id=e),class:"form-control form-control-sm",required:""},[t[23]||(t[23]=a("option",{disabled:"",value:""},"-- pilih golongan --",-1)),(i(!0),r(h,null,M(U.value,e=>(i(),r("option",{value:e.id},n(e.name),9,xa))),256))],512),[[c,o.value.group_id]])]),a("div",ya,[t[25]||(t[25]=a("label",null,"Maksimal Usia",-1)),u(a("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>o.value.max_age=e),type:"number",class:"form-control form-control-sm",min:"0",required:""},null,512),[[k,o.value.max_age,void 0,{number:!0}]])])]),a("div",ka,[a("div",wa,[t[26]||(t[26]=a("label",null,"Urutan",-1)),u(a("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>o.value.order_number=e),type:"number",class:"form-control form-control-sm"},null,512),[[k,o.value.order_number,void 0,{number:!0}]])]),a("div",Ma,[t[28]||(t[28]=a("label",null,"Tim?",-1)),u(a("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>o.value.is_team=e),class:"form-control form-control-sm"},t[27]||(t[27]=[a("option",{value:!1},"Tidak",-1),a("option",{value:!0},"Ya (Tim)",-1)]),512),[[c,o.value.is_team]])]),a("div",Ca,[t[30]||(t[30]=a("label",null,"Status",-1)),u(a("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>o.value.is_active=e),class:"form-control form-control-sm"},t[29]||(t[29]=[a("option",{value:!0},"Aktif",-1),a("option",{value:!1},"Nonaktif",-1)]),512),[[c,o.value.is_active]])])])]),a("div",Ga,[a("button",{class:"btn btn-primary btn-sm",disabled:f.value},[f.value?(i(),r("i",Ua)):(i(),r("i",Ba)),t[31]||(t[31]=w(" Simpan "))],8,Ta)])],32)])])])])])],64))}};export{Da as default};
