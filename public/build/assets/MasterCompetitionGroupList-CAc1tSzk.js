import{z as V,A as i,O as H,V as L,B as r,C as d,D as e,S as m,as as c,K as u,J as n,I as K,U as w,ay as N,H as k,F as y,aB as B,a as f,aC as D}from"./AuthUserStore-67h2FHdL.js";const E={class:"content"},F={class:"container-fluid"},I={class:"card"},z={class:"card-header d-flex justify-content-between align-items-center"},j={class:"text-muted text-sm"},q={class:"card-body table-responsive p-0"},Q={class:"table table-bordered table-hover text-sm"},W={key:0},Y={key:1},J={class:"text-center"},O={class:"text-center"},P={class:"btn-group btn-group-sm"},R=["onClick"],Z=["onClick"],X={class:"card-footer clearfix"},ee={class:"d-flex justify-content-between align-items-center"},te={class:"text-muted text-sm"},ae={class:"pagination pagination-sm m-0"},se={class:"page-item disabled"},oe={class:"page-link"},le={class:"modal fade",id:"groupModal",tabindex:"-1",role:"dialog"},ne={class:"modal-dialog modal-lg",role:"document"},ie={class:"modal-content"},re={class:"modal-header py-2"},de={class:"modal-title",id:"groupModalLabel"},ue={class:"modal-body pt-2"},me={class:"row"},pe={class:"col-md-6"},ce={class:"form-group mb-2"},ve={class:"form-group mb-2"},ge={class:"form-group mb-2"},be={class:"form-group mb-2"},fe={class:"col-md-6"},_e={class:"form-group mb-2"},he={class:"text-end mt-3"},ke=["disabled"],ye={key:0,class:"fas fa-spinner fa-spin me-1"},xe={key:1,class:"fas fa-save me-1"},Me={__name:"MasterCompetitionGroupList",setup(we){const G=V(),_=i([]),l=i({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),v=i(""),h=i(!1),g=i(!1),b=i(!1),s=i({id:null,code:"",name:"",order_number:1,description:"",is_active:!0}),p=async(o=1)=>{h.value=!0;try{const a=(await f.get("/api/v1/master-competition-groups",{params:{page:o,search:v.value}})).data.data;_.value=a.data||[],l.value={current_page:a.current_page,per_page:a.per_page,total:a.total,from:a.from,to:a.to,last_page:a.last_page}}catch(t){t.response&&t.response.status===401?(console.warn("Unauthorized. Logging out..."),G.logout()):console.error("Gagal memuat group kompetisi:",t)}finally{h.value=!1}},x=o=>{o<1||o>l.value.last_page||p(o)},M=()=>{g.value=!1,s.value={id:null,code:"",name:"",order_number:(l.value.total||0)+1,description:"",is_active:!0},$("#groupModal").modal("show")},C=o=>{g.value=!0,s.value={id:o.id,code:o.code,name:o.name,order_number:o.order_number,description:o.description,is_active:!!o.is_active},$("#groupModal").modal("show")},T=async()=>{b.value=!0;const o={code:s.value.code,name:s.value.name,order_number:s.value.order_number,description:s.value.description,is_active:s.value.is_active};try{g.value&&s.value.id?await f.put(`/api/v1/master-competition-groups/${s.value.id}`,o):await f.post("/api/v1/master-competition-groups",o),$("#groupModal").modal("hide"),p(l.value.current_page)}catch(t){console.error("Gagal menyimpan group kompetisi:",t),alert("Gagal menyimpan data group.")}finally{b.value=!1}},A=async o=>{if(confirm(`Yakin ingin menghapus group "${o.name}"?`))try{await f.delete(`/api/v1/master-competition-groups/${o.id}`),p(l.value.current_page)}catch(t){console.error("Gagal menghapus group kompetisi:",t),alert("Gagal menghapus group.")}};return H(()=>v.value,D(()=>p(1),400)),L(()=>{p()}),(o,t)=>(d(),r(w,null,[e("section",{class:"content-header"},[e("div",{class:"container-fluid"},[e("div",{class:"d-flex justify-content-between align-items-center"},[t[8]||(t[8]=e("h1",{class:"mb-2"},"Master Group Kompetisi",-1)),e("button",{class:"btn btn-primary btn-sm",onClick:M}," + Tambah Group ")]),t[9]||(t[9]=e("p",{class:"text-muted text-sm mb-0"}," Group kompetisi digunakan sebagai pengelompokan utama cabang lomba (misalnya: Tilawah, Tahfizh, Syarhil). ",-1))])]),e("section",E,[e("div",F,[e("div",I,[e("div",z,[m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>v.value=a),type:"text",class:"form-control form-control-sm w-50",placeholder:"Cari kode atau nama group..."},null,512),[[c,v.value]]),e("span",j,[t[10]||(t[10]=u(" Total: ")),e("strong",null,n(l.value.total||0),1),t[11]||(t[11]=u(" group "))])]),e("div",q,[e("table",Q,[t[16]||(t[16]=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{style:{width:"40px"}},"#"),e("th",{style:{width:"120px"}},"Kode"),e("th",null,"Nama Group"),e("th",{style:{width:"80px"}},"Urutan"),e("th",null,"Deskripsi"),e("th",{style:{width:"90px"}},"Status"),e("th",{style:{width:"120px"}},"Aksi")])],-1)),e("tbody",null,[h.value?(d(),r("tr",W,t[12]||(t[12]=[e("td",{colspan:"7",class:"text-center"},"Memuat data...",-1)]))):_.value.length===0?(d(),r("tr",Y,t[13]||(t[13]=[e("td",{colspan:"7",class:"text-center"},[u(" Belum ada data group kompetisi. "),e("br"),e("small",{class:"text-muted"},[u(" Klik "),e("strong",null,"Tambah Group"),u(" untuk menambahkan. ")])],-1)]))):K("",!0),(d(!0),r(w,null,N(_.value,(a,S)=>(d(),r("tr",{key:a.id},[e("td",null,n(S+1+(l.value.current_page-1)*l.value.per_page),1),e("td",null,[e("code",null,n(a.code),1)]),e("td",null,[e("strong",null,n(a.name),1)]),e("td",J,n(a.order_number),1),e("td",null,n(a.description||"-"),1),e("td",null,[e("span",{class:k(["badge",a.is_active?"badge-success":"badge-secondary"])},n(a.is_active?"Aktif":"Nonaktif"),3)]),e("td",O,[e("div",P,[e("button",{class:"btn btn-warning",title:"Edit",onClick:U=>C(a)},t[14]||(t[14]=[e("i",{class:"fas fa-edit"},null,-1)]),8,R),e("button",{class:"btn btn-danger",title:"Hapus",onClick:U=>A(a)},t[15]||(t[15]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Z)])])]))),128))])])]),e("div",X,[e("div",ee,[e("div",te," Menampilkan "+n(l.value.from||0)+" - "+n(l.value.to||0)+" dari "+n(l.value.total||0)+" group ",1),e("ul",ae,[e("li",{class:k(["page-item",{disabled:l.value.current_page===1}])},[e("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=y(a=>x(l.value.current_page-1),["prevent"]))}," « ")],2),e("li",se,[e("span",oe," Halaman "+n(l.value.current_page)+" / "+n(l.value.last_page||1),1)]),e("li",{class:k(["page-item",{disabled:l.value.current_page===l.value.last_page}])},[e("a",{class:"page-link",href:"#",onClick:t[2]||(t[2]=y(a=>x(l.value.current_page+1),["prevent"]))}," » ")],2)])])])])]),e("div",le,[e("div",ne,[e("div",ie,[e("div",re,[e("h5",de,[t[17]||(t[17]=e("i",{class:"fas fa-layer-group me-2"},null,-1)),u(" "+n(g.value?"Edit Group Kompetisi":"Tambah Group Kompetisi"),1)]),t[18]||(t[18]=e("button",{type:"button",class:"close","data-dismiss":"modal"},[e("span",null,"×")],-1))]),e("div",ue,[e("form",{onSubmit:y(T,["prevent"])},[e("div",me,[e("div",pe,[e("div",ce,[t[19]||(t[19]=e("label",{class:"mb-1"},"Kode Group",-1)),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.code=a),class:"form-control form-control-sm",required:"",placeholder:"Misal: TILAWAH"},null,512),[[c,s.value.code]]),t[20]||(t[20]=e("small",{class:"text-muted"}," Gunakan huruf kapital dan underscore, misalnya: TILAWAH, TAHFIZH, SYARHIL. ",-1))]),e("div",ve,[t[21]||(t[21]=e("label",{class:"mb-1"},"Nama Group",-1)),m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.name=a),class:"form-control form-control-sm",required:"",placeholder:"Misal: Tilawah Al-Qur'an"},null,512),[[c,s.value.name]])]),e("div",ge,[t[22]||(t[22]=e("label",{class:"mb-1"},"Urutan Tampil",-1)),m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>s.value.order_number=a),type:"number",min:"1",class:"form-control form-control-sm",required:""},null,512),[[c,s.value.order_number,void 0,{number:!0}]])]),e("div",be,[t[24]||(t[24]=e("label",{class:"mb-1"},"Status",-1)),m(e("select",{"onUpdate:modelValue":t[6]||(t[6]=a=>s.value.is_active=a),class:"form-control form-control-sm"},t[23]||(t[23]=[e("option",{value:!0},"Aktif",-1),e("option",{value:!1},"Nonaktif",-1)]),512),[[B,s.value.is_active]])])]),e("div",fe,[e("div",_e,[t[25]||(t[25]=e("label",{class:"mb-1"},"Deskripsi",-1)),m(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=a=>s.value.description=a),rows:"5",class:"form-control form-control-sm",placeholder:"Contoh: Group untuk seluruh cabang Tilawah Al-Qur'an dengan berbagai golongan dan kategori."},null,512),[[c,s.value.description]])])])]),e("div",he,[e("button",{type:"submit",class:"btn btn-sm btn-primary",disabled:b.value},[b.value?(d(),r("i",ye)):(d(),r("i",xe)),t[26]||(t[26]=u(" Simpan "))],8,ke)])],32)])])])])])],64))}};export{Me as default};
