import{B as N,F as r,G as M,J as G,P as u,Q as c,R as t,W as T,Z as B,U as n,ah as k,av as F,ap as K,a5 as S,aw as L,T as P,S as y}from"./pinia-BDOwh8JO.js";import{u as A,b as f}from"./app-qojnDOIY.js";import{S as p}from"./sweetalert2.esm.all-9Qm2jZ7z.js";const H={class:"content-header"},q={class:"container-fluid"},z={class:"d-flex justify-content-between align-items-center"},I={key:0,class:"text-muted d-block"},J={class:"content"},Q={class:"container-fluid"},R={class:"card"},W={class:"card-header"},Y={class:"d-flex justify-content-between align-items-center"},Z={class:"card-body table-responsive p-0"},O={class:"table table-bordered table-hover text-sm mb-0"},X={key:0},tt={key:1},et={class:"text-center"},at={class:"btn-group btn-group-sm"},st=["onClick"],ot=["onClick"],lt={class:"card-footer clearfix py-2"},nt={class:"d-flex justify-content-between align-items-center"},it={class:"text-muted text-sm"},rt={class:"pagination pagination-sm m-0"},dt={class:"page-item disabled"},ut={class:"page-link"},ct={class:"modal fade",id:"participantCategoryModal"},pt={class:"modal-dialog"},mt={class:"modal-content"},vt={class:"modal-header py-2"},gt={class:"modal-body"},ft={class:"form-group"},kt={__name:"ParticipantCategoryList",setup(bt){const b=p.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),j=A(),w=N(()=>j.eventData||null),h=r([]),m=r(""),v=r(10),_=r(!1),g=r(!1),s=r({current_page:1,last_page:1,from:0,to:0,total:0}),i=r({id:null,name:""}),d=async(o=1)=>{var e,a;_.value=!0;try{const l=await f.get("/api/v1/participant-categories",{params:{search:m.value,per_page:v.value,page:o}});h.value=l.data.data.data,s.value=l.data.data}catch(l){p.fire({icon:"error",title:"Gagal memuat kategori peserta",text:((a=(e=l.response)==null?void 0:e.data)==null?void 0:a.message)||"Terjadi kesalahan sistem"})}finally{_.value=!1}},E=()=>{g.value=!1,i.value={id:null,name:""},$("#participantCategoryModal").modal("show")},U=o=>{g.value=!0,i.value={...o},$("#participantCategoryModal").modal("show")},V=async()=>{var o,e;try{g.value?(await f.put(`/api/v1/participant-categories/${i.value.id}`,i.value),b.fire({icon:"success",title:"Kategori peserta berhasil diperbarui"})):(await f.post("/api/v1/participant-categories",i.value),b.fire({icon:"success",title:"Kategori peserta berhasil ditambahkan"})),$("#participantCategoryModal").modal("hide"),d(s.value.current_page)}catch(a){p.fire({icon:"error",title:"Gagal menyimpan kategori",text:((e=(o=a.response)==null?void 0:o.data)==null?void 0:e.message)||"Terjadi kesalahan sistem"})}},D=async o=>{var a,l;if((await p.fire({title:"Hapus kategori?",text:`Kategori "${o.name}" akan dihapus`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{await f.delete(`/api/v1/participant-categories/${o.id}`),b.fire({icon:"success",title:"Kategori peserta berhasil dihapus"}),d(s.value.current_page)}catch(x){p.fire({icon:"error",title:"Gagal menghapus kategori",text:((l=(a=x.response)==null?void 0:a.data)==null?void 0:l.message)||"Terjadi kesalahan sistem"})}},C=o=>{o<1||o>s.value.last_page||d(o)};return M(m,()=>d(1)),M(v,()=>d(1)),G(()=>d()),(o,e)=>(c(),u(S,null,[t("section",H,[t("div",q,[t("div",z,[t("div",null,[e[6]||(e[6]=t("h1",{class:"mb-1"},"Participant Categories",-1)),w.value?(c(),u("small",I,[e[5]||(e[5]=B(" Event: ")),t("strong",null,n(w.value.name),1)])):T("",!0)]),t("button",{class:"btn btn-primary btn-sm",onClick:E}," + Tambah Kategori ")])])]),t("section",J,[t("div",Q,[t("div",R,[t("div",W,[t("div",Y,[t("div",null,[e[8]||(e[8]=t("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),k(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),class:"form-control form-control-sm d-inline-block w-auto"},e[7]||(e[7]=[t("option",{value:10},"10",-1),t("option",{value:25},"25",-1),t("option",{value:50},"50",-1)]),512),[[F,v.value,void 0,{number:!0}]]),e[9]||(e[9]=t("span",{class:"text-sm text-muted ml-1"},"Entri",-1))]),k(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>m.value=a),type:"text",class:"form-control form-control-sm w-auto",style:{"min-width":"220px"},placeholder:"Cari kategori..."},null,512),[[K,m.value]])])]),t("div",Z,[t("table",O,[e[14]||(e[14]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",null,"Nama Kategori"),t("th",{style:{width:"110px"},class:"text-center"},"Aksi")])],-1)),t("tbody",null,[_.value?(c(),u("tr",X,e[10]||(e[10]=[t("td",{colspan:"3",class:"text-center"},"Memuat data...",-1)]))):h.value.length===0?(c(),u("tr",tt,e[11]||(e[11]=[t("td",{colspan:"3",class:"text-center text-muted"}," Belum ada kategori peserta. ",-1)]))):T("",!0),(c(!0),u(S,null,L(h.value,(a,l)=>(c(),u("tr",{key:a.id},[t("td",null,n(l+1+(s.value.current_page-1)*s.value.per_page),1),t("td",null,[t("strong",null,n(a.name),1)]),t("td",et,[t("div",at,[t("button",{class:"btn btn-warning",onClick:x=>U(a)},e[12]||(e[12]=[t("i",{class:"fas fa-edit"},null,-1)]),8,st),t("button",{class:"btn btn-danger",onClick:x=>D(a)},e[13]||(e[13]=[t("i",{class:"fas fa-trash"},null,-1)]),8,ot)])])]))),128))])])]),t("div",lt,[t("div",nt,[t("div",it," Menampilkan "+n(s.value.from||0)+" – "+n(s.value.to||0)+" dari "+n(s.value.total||0)+" data ",1),t("ul",rt,[t("li",{class:P(["page-item",{disabled:s.value.current_page===1}])},[t("a",{href:"#",class:"page-link",onClick:e[2]||(e[2]=y(a=>C(s.value.current_page-1),["prevent"]))},"«")],2),t("li",dt,[t("span",ut," Halaman "+n(s.value.current_page)+" / "+n(s.value.last_page),1)]),t("li",{class:P(["page-item",{disabled:s.value.current_page===s.value.last_page}])},[t("a",{href:"#",class:"page-link",onClick:e[3]||(e[3]=y(a=>C(s.value.current_page+1),["prevent"]))},"»")],2)])])])])]),t("div",ct,[t("div",pt,[t("div",mt,[t("div",vt,[t("h5",null,n(g.value?"Edit Kategori Peserta":"Tambah Kategori Peserta"),1),e[15]||(e[15]=t("button",{class:"close","data-dismiss":"modal"},"×",-1))]),t("div",gt,[t("form",{onSubmit:y(V,["prevent"])},[t("div",ft,[e[16]||(e[16]=t("label",null,"Nama Kategori",-1)),k(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>i.value.name=a),class:"form-control form-control-sm",required:""},null,512),[[K,i.value.name]])]),e[17]||(e[17]=t("div",{class:"text-right"},[t("button",{class:"btn btn-primary btn-sm"},[t("i",{class:"fas fa-save mr-1"}),B(" Simpan ")])],-1))],32)])])])])])],64))}};export{kt as default};
