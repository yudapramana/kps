import{z as I,A as u,O as K,V as O,B as i,C as r,D as t,S as d,as as v,aB as m,U as g,ay as f,K as p,J as l,I as z,H as P,F as V,a as _,aC as S}from"./AuthUserStore-67h2FHdL.js";import{_ as R}from"./app-CZBZEz52.js";const j={class:"content"},J={class:"container-fluid"},W={class:"card"},Y={class:"card-header"},Q={class:"row align-items-center"},X={class:"col-md-4 mb-2 mb-md-0"},Z={class:"col-md-3 mb-2 mb-md-0"},tt=["value"],et={class:"col-md-3 mb-2 mb-md-0"},at=["value"],ot={class:"col-md-2 text-right"},st={class:"text-muted text-sm"},lt={class:"card-body table-responsive p-0"},nt={class:"table table-bordered table-hover text-sm"},it={key:0},rt={key:1},dt={class:"text-center"},ut={key:0},mt={key:1},pt={class:"text-center"},ct={class:"text-center"},vt={class:"btn-group btn-group-sm"},gt=["onClick"],_t=["onClick"],ft={class:"card-footer clearfix"},bt={class:"d-flex justify-content-between align-items-center"},yt={class:"text-muted text-sm"},kt={class:"pagination pagination-sm m-0"},xt={class:"page-item disabled"},wt={class:"page-link"},ht={class:"modal fade",id:"masterBranchModal",tabindex:"-1",role:"dialog"},Ct={class:"modal-dialog modal-lg",role:"document"},Gt={class:"modal-content"},Ut={class:"modal-header py-2"},Mt={class:"modal-title",id:"masterBranchModalLabel"},Pt={class:"modal-body pt-2"},Vt={class:"row"},Bt={class:"col-md-6"},At={class:"form-group mb-2"},Tt={class:"form-group mb-2"},Kt=["value"],St={class:"form-group mb-2"},$t=["value"],Nt={class:"form-group mb-2"},qt={class:"form-group mb-2"},Ft={class:"col-md-6"},Lt={class:"form-group mb-2"},Dt={class:"form-group mb-2"},Et={class:"form-group mb-2"},Ht={class:"form-group mb-2"},It={class:"form-group mb-2"},Ot={class:"text-end mt-3"},zt=["disabled"],Rt={key:0,class:"fas fa-spinner fa-spin me-1"},jt={key:1,class:"fas fa-save me-1"},Jt={__name:"MasterCompetitionBranchList",setup(Wt){const N=I(),h=u([]),n=u({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),b=u(""),y=u(""),k=u(""),C=u(!1),x=u(!1),w=u(!1),o=u({id:null,code:"",master_competition_group_id:"",master_competition_category_id:"",type:"Putra",format:"individu",name:"",max_age:0,order_number:1,description:"",is_active:!0}),G=u([]),U=u([]),q=async()=>{try{const[s,e]=await Promise.all([_.get("/api/v1/master-competition-groups",{params:{per_page:999}}),_.get("/api/v1/master-competition-categories",{params:{per_page:999}})]),a=s.data.data;G.value=a.data||[];const M=e.data.data;U.value=M.data||[]}catch(s){console.error("Gagal memuat master group/category:",s)}},c=async(s=1)=>{C.value=!0;try{const a=(await _.get("/api/v1/master-competition-branches",{params:{page:s,search:b.value,group_id:y.value||void 0,category_id:k.value||void 0}})).data.data;h.value=a.data||[],n.value={current_page:a.current_page,per_page:a.per_page,total:a.total,from:a.from,to:a.to,last_page:a.last_page}}catch(e){e.response&&e.response.status===401?(console.warn("Unauthorized. Logging out..."),N.logout()):console.error("Gagal memuat cabang kompetisi:",e)}finally{C.value=!1}},B=s=>{s<1||s>n.value.last_page||c(s)},F=()=>{x.value=!1,o.value={id:null,code:"",master_competition_group_id:"",master_competition_category_id:"",type:"Putra",format:"individu",name:"",max_age:0,order_number:(n.value.total||0)+1,description:"",is_active:!0},$("#masterBranchModal").modal("show")},L=s=>{x.value=!0,o.value={id:s.id,code:s.code,master_competition_group_id:s.master_competition_group_id,master_competition_category_id:s.master_competition_category_id,type:s.type,format:s.format,name:s.name,max_age:s.max_age,order_number:s.order_number,description:s.description,is_active:!!s.is_active},$("#masterBranchModal").modal("show")},D=async()=>{w.value=!0;const s={code:o.value.code,master_competition_group_id:o.value.master_competition_group_id,master_competition_category_id:o.value.master_competition_category_id,type:o.value.type,format:o.value.format,name:o.value.name,max_age:o.value.max_age,order_number:o.value.order_number,description:o.value.description,is_active:o.value.is_active};try{x.value&&o.value.id?await _.put(`/api/v1/master-competition-branches/${o.value.id}`,s):await _.post("/api/v1/master-competition-branches",s),$("#masterBranchModal").modal("hide"),c(n.value.current_page)}catch(e){console.error("Gagal menyimpan cabang kompetisi:",e),alert("Gagal menyimpan data cabang/golongan.")}finally{w.value=!1}},E=async s=>{if(confirm(`Yakin ingin menghapus cabang/golongan "${s.name}"?`))try{await _.delete(`/api/v1/master-competition-branches/${s.id}`),c(n.value.current_page)}catch(e){console.error("Gagal menghapus cabang kompetisi:",e),alert("Gagal menghapus cabang/golongan.")}};return K(()=>b.value,S(()=>c(1),400)),K(()=>[y.value,k.value],S(()=>c(1),300),{deep:!0}),O(async()=>{await q(),c()}),(s,e)=>(r(),i(g,null,[t("section",{class:"content-header"},[t("div",{class:"container-fluid"},[t("div",{class:"d-flex justify-content-between align-items-center"},[e[15]||(e[15]=t("h1",{class:"mb-2"},"Master Cabang / Golongan Kompetisi",-1)),t("button",{class:"btn btn-primary btn-sm",onClick:F}," + Tambah Cabang/Golongan ")]),e[16]||(e[16]=t("p",{class:"text-muted text-sm mb-0"}," Cabang/golongan kompetisi adalah kombinasi Group, Kategori, Type (Putra/Putri), dan Format (individu/grup). ",-1))])]),t("section",j,[t("div",J,[t("div",W,[t("div",Y,[t("div",Q,[t("div",X,[d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),type:"text",class:"form-control form-control-sm",placeholder:"Cari kode, nama, atau kombinasi..."},null,512),[[v,b.value]])]),t("div",Z,[d(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>y.value=a),class:"form-control form-control-sm"},[e[17]||(e[17]=t("option",{value:""},"-- Semua Group --",-1)),(r(!0),i(g,null,f(G.value,a=>(r(),i("option",{key:a.id,value:a.id},l(a.name),9,tt))),128))],512),[[m,y.value]])]),t("div",et,[d(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>k.value=a),class:"form-control form-control-sm"},[e[18]||(e[18]=t("option",{value:""},"-- Semua Kategori --",-1)),(r(!0),i(g,null,f(U.value,a=>(r(),i("option",{key:a.id,value:a.id},l(a.name),9,at))),128))],512),[[m,k.value]])]),t("div",ot,[t("span",st,[e[19]||(e[19]=p(" Total: ")),t("strong",null,l(n.value.total||0),1),e[20]||(e[20]=p(" cabang "))])])])]),t("div",lt,[t("table",nt,[e[25]||(e[25]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",null,"Nama Cabang/Golongan"),t("th",null,"Group"),t("th",null,"Kategori"),t("th",{style:{width:"80px"}},"Type"),t("th",{style:{width:"80px"}},"Format"),t("th",{style:{width:"80px"}},"Max Umur"),t("th",{style:{width:"80px"}},"Urutan"),t("th",{style:{width:"90px"}},"Status"),t("th",{style:{width:"90px"},class:"text-center"},"Aksi")])],-1)),t("tbody",null,[C.value?(r(),i("tr",it,e[21]||(e[21]=[t("td",{colspan:"11",class:"text-center"},"Memuat data...",-1)]))):h.value.length===0?(r(),i("tr",rt,e[22]||(e[22]=[t("td",{colspan:"11",class:"text-center"},[p(" Belum ada data cabang/golongan kompetisi. "),t("br"),t("small",{class:"text-muted"},[p(" Klik "),t("strong",null,"Tambah Cabang/Golongan"),p(" untuk menambahkan. ")])],-1)]))):z("",!0),(r(!0),i(g,null,f(h.value,(a,M)=>{var A,T;return r(),i("tr",{key:a.id},[t("td",null,l(M+1+(n.value.current_page-1)*n.value.per_page),1),t("td",null,[t("strong",null,l(a.name),1)]),t("td",null,l(((A=a.group)==null?void 0:A.name)||"-"),1),t("td",null,l(((T=a.category)==null?void 0:T.name)||"-"),1),t("td",null,l(a.type),1),t("td",null,l(a.format),1),t("td",dt,[a.max_age>0?(r(),i("span",ut,l(a.max_age),1)):(r(),i("span",mt,"-"))]),t("td",pt,l(a.order_number),1),t("td",null,[t("span",{class:P(["badge",a.is_active?"badge-success":"badge-secondary"])},l(a.is_active?"Aktif":"Nonaktif"),3)]),t("td",ct,[t("div",vt,[t("button",{class:"btn btn-warning",onClick:H=>L(a),title:"Edit"},e[23]||(e[23]=[t("i",{class:"fas fa-edit"},null,-1)]),8,gt),t("button",{class:"btn btn-danger",onClick:H=>E(a),title:"Hapus"},e[24]||(e[24]=[t("i",{class:"fas fa-trash"},null,-1)]),8,_t)])])])}),128))])])]),t("div",ft,[t("div",bt,[t("div",yt," Menampilkan "+l(n.value.from||0)+" - "+l(n.value.to||0)+" dari "+l(n.value.total||0)+" cabang ",1),t("ul",kt,[t("li",{class:P(["page-item",{disabled:n.value.current_page===1}])},[t("a",{class:"page-link",href:"#",onClick:e[3]||(e[3]=V(a=>B(n.value.current_page-1),["prevent"]))}," « ")],2),t("li",xt,[t("span",wt," Halaman "+l(n.value.current_page)+" / "+l(n.value.last_page||1),1)]),t("li",{class:P(["page-item",{disabled:n.value.current_page===n.value.last_page}])},[t("a",{class:"page-link",href:"#",onClick:e[4]||(e[4]=V(a=>B(n.value.current_page+1),["prevent"]))}," » ")],2)])])])])]),t("div",ht,[t("div",Ct,[t("div",Gt,[t("div",Ut,[t("h5",Mt,[e[26]||(e[26]=t("i",{class:"fas fa-sitemap me-2"},null,-1)),p(" "+l(x.value?"Edit Cabang/Golongan":"Tambah Cabang/Golongan"),1)]),e[27]||(e[27]=t("button",{type:"button",class:"close","data-dismiss":"modal"},[t("span",null,"×")],-1))]),t("div",Pt,[t("form",{onSubmit:V(D,["prevent"])},[t("div",Vt,[t("div",Bt,[t("div",At,[e[28]||(e[28]=t("label",{class:"mb-1"},"Kode",-1)),d(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.code=a),class:"form-control form-control-sm",required:"",placeholder:"Misal: TILAWAH_ANAK_PUTRA"},null,512),[[v,o.value.code]]),e[29]||(e[29]=t("small",{class:"text-muted"}," Gunakan huruf kapital & underscore (kode unik). ",-1))]),t("div",Tt,[e[31]||(e[31]=t("label",{class:"mb-1"},"Group Kompetisi",-1)),d(t("select",{"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.master_competition_group_id=a),class:"form-control form-control-sm",required:""},[e[30]||(e[30]=t("option",{value:""},"-- Pilih Group --",-1)),(r(!0),i(g,null,f(G.value,a=>(r(),i("option",{key:a.id,value:a.id},l(a.name),9,Kt))),128))],512),[[m,o.value.master_competition_group_id]])]),t("div",St,[e[33]||(e[33]=t("label",{class:"mb-1"},"Kategori Kompetisi",-1)),d(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.master_competition_category_id=a),class:"form-control form-control-sm",required:""},[e[32]||(e[32]=t("option",{value:""},"-- Pilih Kategori --",-1)),(r(!0),i(g,null,f(U.value,a=>(r(),i("option",{key:a.id,value:a.id},l(a.name),9,$t))),128))],512),[[m,o.value.master_competition_category_id]])]),t("div",Nt,[e[35]||(e[35]=t("label",{class:"mb-1"},"Type",-1)),d(t("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.type=a),class:"form-control form-control-sm",required:""},e[34]||(e[34]=[t("option",{value:"Putra"},"Putra",-1),t("option",{value:"Putri"},"Putri",-1)]),512),[[m,o.value.type]])]),t("div",qt,[e[37]||(e[37]=t("label",{class:"mb-1"},"Format",-1)),d(t("select",{"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.format=a),class:"form-control form-control-sm",required:""},e[36]||(e[36]=[t("option",{value:"individu"},"Individu",-1),t("option",{value:"grup"},"Grup",-1)]),512),[[m,o.value.format]])])]),t("div",Ft,[t("div",Lt,[e[38]||(e[38]=t("label",{class:"mb-1"},"Nama Cabang/Golongan",-1)),d(t("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.name=a),class:"form-control form-control-sm",required:"",placeholder:"Misal: Tilawah Anak-Anak Putra"},null,512),[[v,o.value.name]])]),t("div",Dt,[e[39]||(e[39]=t("label",{class:"mb-1"},"Maksimal Umur",-1)),d(t("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.max_age=a),type:"number",min:"0",class:"form-control form-control-sm",placeholder:"0 = tanpa batasan"},null,512),[[v,o.value.max_age,void 0,{number:!0}]])]),t("div",Et,[e[40]||(e[40]=t("label",{class:"mb-1"},"Urutan Tampil",-1)),d(t("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>o.value.order_number=a),type:"number",min:"1",class:"form-control form-control-sm",required:""},null,512),[[v,o.value.order_number,void 0,{number:!0}]])]),t("div",Ht,[e[41]||(e[41]=t("label",{class:"mb-1"},"Deskripsi",-1)),d(t("textarea",{"onUpdate:modelValue":e[13]||(e[13]=a=>o.value.description=a),rows:"3",class:"form-control form-control-sm",placeholder:"Contoh: Tilawah Golongan Anak-Anak Putra, maksimal usia 12 tahun."},null,512),[[v,o.value.description]])]),t("div",It,[e[43]||(e[43]=t("label",{class:"mb-1"},"Status",-1)),d(t("select",{"onUpdate:modelValue":e[14]||(e[14]=a=>o.value.is_active=a),class:"form-control form-control-sm"},e[42]||(e[42]=[t("option",{value:!0},"Aktif",-1),t("option",{value:!1},"Nonaktif",-1)]),512),[[m,o.value.is_active]])])])]),t("div",Ot,[t("button",{type:"submit",class:"btn btn-sm btn-primary",disabled:w.value},[w.value?(r(),i("i",Rt)):(r(),i("i",jt)),e[44]||(e[44]=p(" Simpan "))],8,zt)])],32)])])])])])],64))}},Xt=R(Jt,[["__scopeId","data-v-4df9c22f"]]);export{Xt as default};
