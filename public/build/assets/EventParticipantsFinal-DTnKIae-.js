import{z as G,y as P,A as d,O as _,V as z,B as o,C as r,D as e,I as v,K as m,Q as C,S as D,aB as H,as as O,U as R,ay as J,J as l,H as M,F as S,a as Q,aC as Y}from"./AuthUserStore-67h2FHdL.js";import{S as U}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{_ as q}from"./ViewParticipantModal-CgJpdFjl.js";import{R as W}from"./ReRegisterModal-DSGeArW_.js";import{_ as X}from"./app-CZBZEz52.js";import"./EventParticipantHelpers-CO5Top6O.js";const Z={class:"content-header"},ee={class:"container-fluid"},te={key:0,class:"text-danger text-sm mt-2 mb-0"},ae={class:"content"},se={class:"container-fluid"},ne={class:"card"},le={class:"card-header"},oe={class:"d-flex flex-wrap justify-content-between align-items-center w-100"},re={class:"d-flex flex-wrap align-items-center"},ie={class:"d-flex align-items-center mt-2 mt-sm-0"},de=["disabled"],ue={class:"card-body table-responsive p-0"},ce={class:"table table-bordered table-hover text-sm mb-0"},pe={key:0},ve={key:1},me={class:"text-center"},ge={key:0,class:"text-xs text-muted"},_e={key:0,class:"text-xs text-muted"},fe={class:"badge badge-light border"},be={class:"text-center"},he={class:"btn-group btn-group-sm"},xe=["onClick"],ye=["onClick"],ke={class:"card-footer clearfix py-2"},we={class:"d-flex justify-content-between align-items-center"},Pe={class:"text-muted text-sm"},Ce={class:"pagination pagination-sm m-0"},De={class:"page-item disabled"},Re={class:"page-link"},Me={__name:"EventParticipantsFinal",setup(Se){const E=G(),K=P(()=>E.eventData||null),i=P(()=>{var s;return((s=K.value)==null?void 0:s.id)||null}),f=d([]),c=d(""),p=d(10),g=d(!1),N=d({reregistration_status:""}),n=d({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),b=d(null),V=s=>{b.value=s,$("#viewParticipantModal").modal("show")},h=d(null),F=s=>{const t=["verified","diterima","accepted"].includes(((s==null?void 0:s.registration_status)||"").toLowerCase()),a=["not_yet","",null].includes(s==null?void 0:s.reregistration_status);return t&&a},B=s=>{h.value=s,$("#reRegisterModal").modal("show")},I=()=>{u(n.value.current_page||1)},L=s=>s+1+(n.value.current_page-1)*n.value.per_page,u=async(s=1)=>{if(i.value){g.value=!0;try{const a=(await Q.get(`/api/v1/events/${i.value}/participants`,{params:{page:s,per_page:p.value,search:c.value,registration_status:"verified",reregistration_status:"verified"}})).data;f.value=a.data||[],n.value={current_page:a.current_page,per_page:a.per_page,total:a.total,from:a.from,to:a.to,last_page:a.last_page}}catch(t){console.error(t),U.fire("Gagal","Gagal memuat data peserta event.","error")}finally{g.value=!1}}},x=s=>{s<1||s>n.value.last_page||u(s)},T=async()=>{if(!i.value)return;const s=new URLSearchParams({per_page:String(p.value||10),search:c.value||"",registration_status:"verified",reregistration_status:"verified"}),t=`/api/v1/events/${i.value}/kafilah-pdf?${s.toString()}`;window.open(t,"_blank")};return _(()=>c.value,Y(()=>u(1),400)),_(()=>p.value,()=>u(1)),_(()=>({...N.value}),()=>u(1)),_(()=>i.value,s=>{s&&u(1)}),z(()=>{i.value?u(1):U.fire("Event belum dipilih","Silakan pilih event melalui Portal Event terlebih dahulu.","info")}),(s,t)=>(r(),o(R,null,[e("section",Z,[e("div",ee,[t[5]||(t[5]=e("div",{class:"d-flex justify-content-between align-items-center"},[e("div",null,[e("h1",{class:"mb-1"},"Pendaftaran Ulang Peserta"),e("p",{class:"mb-0 text-muted text-sm"}," Mengelola peserta yang terdaftar pada event aktif, yaitu daftar ulang. ")])],-1)),i.value?v("",!0):(r(),o("p",te,t[4]||(t[4]=[e("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),m(" Event belum dipilih. Silakan pilih event melalui Portal Event terlebih dahulu. ")])))])]),e("section",ae,[e("div",se,[e("div",ne,[e("div",le,[e("div",oe,[e("div",re,[t[7]||(t[7]=e("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),D(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>p.value=a),class:"form-control form-control-sm w-auto mr-2"},t[6]||(t[6]=[e("option",{value:10},"10",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1)]),512),[[H,p.value,void 0,{number:!0}]]),t[8]||(t[8]=e("label",{class:"mb-0 text-sm text-muted mr-3"},"Entri",-1))]),e("div",ie,[D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>c.value=a),type:"text",class:"form-control form-control-sm w-auto",style:{"min-width":"240px"},placeholder:"Cari NIK / Nama / Kontingen..."},null,512),[[O,c.value]]),e("button",{class:"btn btn-sm btn-outline-danger ml-2",disabled:!i.value||g.value,onClick:T,title:"Download PDF Daftar Kafilah"},t[9]||(t[9]=[e("i",{class:"fas fa-file-pdf mr-1"},null,-1),m(" Download PDF ")]),8,de)])])]),e("div",ue,[e("table",ce,[t[14]||(t[14]=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{style:{width:"50px"}},"#"),e("th",{style:{width:"180px"}},"NIK"),e("th",null,"Peserta"),e("th",null,"Cabang / Golongan"),e("th",{style:{width:"160px"}},"Kontingen"),e("th",{style:{width:"140px"},class:"text-center"},"Aksi")])],-1)),e("tbody",null,[g.value?(r(),o("tr",pe,t[10]||(t[10]=[e("td",{colspan:"7",class:"text-center py-4"},"Memuat data peserta event...",-1)]))):f.value.length===0?(r(),o("tr",ve,t[11]||(t[11]=[e("td",{colspan:"7",class:"text-center py-4"},[m(" Belum ada peserta terdaftar untuk event ini. "),e("br"),e("small",{class:"text-muted"},[m(" Klik "),e("strong",null,"Tambah Peserta Event"),m(" untuk menambahkan peserta. ")])],-1)]))):v("",!0),(r(!0),o(R,null,J(f.value,(a,j)=>{var y,k,w;return r(),o("tr",{key:a.id},[e("td",me,l(L(j)),1),e("td",null,[e("strong",null,l(((y=a.participant)==null?void 0:y.nik)||"-"),1),a.age_year!==null&&a.age_year!==void 0?(r(),o("div",ge)):v("",!0)]),e("td",null,[e("strong",null,l(((k=a.participant)==null?void 0:k.full_name)||"-"),1)]),e("td",null,[e("strong",null,l(((w=a.event_category)==null?void 0:w.full_name)||"-"),1),a.event_group?(r(),o("div",_e)):v("",!0)]),e("td",null,[e("span",fe,l(a.contingent||"-"),1)]),e("td",be,[e("div",he,[e("button",{class:"btn btn-outline-primary btn-xs",title:"Lihat Data Peserta",onClick:A=>V(a)},t[12]||(t[12]=[e("i",{class:"fas fa-eye"},null,-1)]),8,xe),F(a)?(r(),o("button",{key:0,class:"btn btn-outline-warning btn-xs",title:"Proses Daftar Ulang",onClick:A=>B(a)},t[13]||(t[13]=[e("i",{class:"fas fa-user-check"},null,-1)]),8,ye)):v("",!0)])])])}),128))])])]),e("div",ke,[e("div",we,[e("div",Pe," Menampilkan "+l(n.value.from||0)+" - "+l(n.value.to||0)+" dari "+l(n.value.total||0)+" peserta event ",1),e("ul",Ce,[e("li",{class:M(["page-item",{disabled:n.value.current_page===1}])},[e("a",{href:"#",class:"page-link",onClick:t[2]||(t[2]=S(a=>x(n.value.current_page-1),["prevent"]))},"«")],2),e("li",De,[e("span",Re,"Halaman "+l(n.value.current_page)+" / "+l(n.value.last_page||1),1)]),e("li",{class:M(["page-item",{disabled:n.value.current_page===n.value.last_page}])},[e("a",{href:"#",class:"page-link",onClick:t[3]||(t[3]=S(a=>x(n.value.current_page+1),["prevent"]))},"»")],2)])])])])]),C(q,{"selected-participant":b.value},null,8,["selected-participant"]),C(W,{"event-participant":h.value,onUpdated:I},null,8,["event-participant"])])],64))}},Fe=X(Me,[["__scopeId","data-v-dabdd8cc"]]);export{Fe as default};
