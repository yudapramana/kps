import{F as p,G as C,J as L,P as o,Q as d,as as N,R as t,ah as f,av as R,ap as G,T as g,W as c,a5 as F,aw as H,U as n,S as V,Z as _}from"./pinia-BDOwh8JO.js";import{_ as z,b as D,e as I}from"./app-Cc4vFrcH.js";import{S as y}from"./sweetalert2.esm.all-9Qm2jZ7z.js";const J={class:"content"},K={class:"container-fluid"},O={class:"card"},Q={class:"card-header"},W={class:"d-flex justify-content-between align-items-center w-100 flex-wrap gap-2"},Z={class:"d-flex align-items-center gap-2 flex-wrap"},q={class:"d-flex align-items-center gap-2"},X=["disabled"],Y={class:"card-body table-responsive p-0"},tt={class:"table table-bordered table-hover text-sm mb-0"},et={key:0},st={key:1},at={key:0,class:"badge badge-warning"},lt={key:1,class:"badge badge-primary"},nt={class:"text-center"},it=["onClick"],ot={class:"card-footer clearfix py-2"},dt={class:"d-flex justify-content-between align-items-center"},rt={class:"text-muted text-sm"},ut={class:"pagination pagination-sm m-0"},pt={class:"page-item disabled"},vt={class:"page-link"},mt={class:"modal fade",id:"paperReviewModal"},ct={class:"modal-dialog modal-lg modal-dialog-scrollable"},bt={class:"modal-content"},ft={class:"modal-header py-2"},gt={class:"modal-title"},_t={key:0,class:"modal-body"},yt={class:"mb-3"},wt={class:"fw-bold mb-1"},xt={class:"text-muted small mb-1"},ht={class:"small text-muted"},kt={class:"mb-4"},Rt={class:"p-3 border rounded-3 bg-white",style:{"text-align":"justify","line-height":"1.7","font-size":"0.95rem"}},St={class:"mb-3"},Ct=["href"],Pt={class:"form-group"},Tt={key:0,class:"form-group"},jt={class:"modal-footer py-2"},Mt=["disabled"],Ft={key:0,class:"spinner-border spinner-border-sm me-1"},Vt={__name:"PaperReviewList",setup(Dt){const A=y.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),S=p([]),l=p({}),w=p(""),x=p(10),b=p(!1),i=p(null),h=p(!1),k=p(""),r=p({status:"",final_status:null}),B=a=>{i.value=a,r.value={status:a.status,final_status:a.final_status},$("#paperReviewModal").modal("show")},E=async()=>{var a,e;if(!r.value.status)return y.fire({icon:"warning",title:"Status belum dipilih"});if(r.value.status==="accepted"&&!r.value.final_status)return y.fire({icon:"warning",title:"Final presentation belum dipilih"});h.value=!0;try{await D.put(`/api/v1/papers/${i.value.id}/review`,r.value),A.fire({icon:"success",title:"Keputusan review berhasil disimpan"}),$("#paperReviewModal").modal("hide"),v(l.value.current_page)}catch(u){y.fire({icon:"error",title:"Gagal menyimpan keputusan",text:((e=(a=u.response)==null?void 0:a.data)==null?void 0:e.message)||"Terjadi kesalahan sistem"})}finally{h.value=!1}},v=async(a=1)=>{var e,u;b.value=!0;try{const m=await D.get("/api/v1/papers/review",{params:{page:a,per_page:x.value,search:w.value,paper_type:k.value}});S.value=m.data.data.data,l.value=m.data.data}catch(m){y.fire({icon:"error",title:"Gagal memuat data paper",text:((u=(e=m.response)==null?void 0:e.data)==null?void 0:u.message)||"Terjadi kesalahan sistem"})}finally{b.value=!1}},P=a=>{a<1||a>l.value.last_page||v(a)},T=a=>{var u;const e=(u=a==null?void 0:a.paper_type)==null?void 0:u.code;return e?e==="RESEARCH"?"badge-info":"badge-purple":"badge-secondary"},j=a=>a?new Date(a).toLocaleString("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return C(k,()=>v(1)),C(w,I(()=>v(1),400)),C(x,()=>v(1)),L(v),(a,e)=>{var u,m;return d(),o(F,null,[e[31]||(e[31]=N('<section class="content-header" data-v-5086d39f><div class="container-fluid" data-v-5086d39f><div class="d-flex justify-content-between align-items-center" data-v-5086d39f><div data-v-5086d39f><h1 class="mb-1" data-v-5086d39f>Paper Review</h1><p class="mb-0 text-muted text-sm" data-v-5086d39f> Review dan validasi abstract / case yang masuk. </p></div></div></div></section>',1)),t("section",J,[t("div",K,[t("div",O,[t("div",Q,[t("div",W,[t("div",Z,[t("div",null,[e[10]||(e[10]=t("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),class:"form-control form-control-sm d-inline-block w-auto"},e[8]||(e[8]=[t("option",{value:10},"10",-1),t("option",{value:25},"25",-1),t("option",{value:50},"50",-1)]),512),[[R,x.value,void 0,{number:!0}]]),e[11]||(e[11]=t("span",{class:"text-sm text-muted ml-1 mr-3"},"Entri",-1)),f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>k.value=s),class:"form-control form-control-sm d-inline-block w-auto",style:{"min-width":"160px"}},e[9]||(e[9]=[t("option",{value:""},"All Types",-1),t("option",{value:"RESEARCH"},"Research",-1),t("option",{value:"CASE"},"Case",-1)]),512),[[R,k.value]])])]),t("div",q,[f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>w.value=s),type:"text",class:"form-control form-control-sm",style:{"min-width":"240px"},placeholder:"Cari judul..."},null,512),[[G,w.value]]),t("button",{class:"btn btn-outline-secondary btn-sm",onClick:e[3]||(e[3]=s=>v(l.value.current_page||1)),disabled:b.value,title:"Refresh"},[t("i",{class:g(["fas fa-sync-alt",{"fa-spin":b.value}])},null,2)],8,X)])])]),t("div",Y,[t("table",tt,[e[16]||(e[16]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",null,"Nama"),t("th",null,"Judul"),t("th",{style:{width:"140px"}},"Tipe"),t("th",{style:{width:"140px"}},"Status"),t("th",{style:{width:"160px"},class:"text-center"},"Aksi")])],-1)),t("tbody",null,[b.value?(d(),o("tr",et,e[12]||(e[12]=[t("td",{colspan:"5",class:"text-center"},"Memuat data...",-1)]))):S.value.length===0?(d(),o("tr",st,e[13]||(e[13]=[t("td",{colspan:"5",class:"text-center text-muted"}," Tidak ada paper untuk direview. ",-1)]))):c("",!0),(d(!0),o(F,null,H(S.value,(s,U)=>{var M;return d(),o("tr",{key:s.id},[t("td",null,n(U+1+(l.value.current_page-1)*l.value.per_page),1),t("td",null,[t("strong",null,n(s.participant.full_name),1)]),t("td",null,[t("strong",null,n(s.title),1),e[14]||(e[14]=t("br",null,null,-1))]),t("td",null,[t("span",{class:g(["badge text-uppercase ms-2",T(s)])},n((M=s.paper_type)==null?void 0:M.name),3)]),t("td",null,[s.status==="submitted"?(d(),o("span",at," Submitted ")):s.status==="under_review"?(d(),o("span",lt," Under Review ")):c("",!0)]),t("td",nt,[t("button",{class:"btn btn-primary btn-sm",onClick:At=>B(s)},e[15]||(e[15]=[t("i",{class:"fas fa-search"},null,-1),_(" Review ")]),8,it)])])}),128))])])]),t("div",ot,[t("div",dt,[t("div",rt," Menampilkan "+n(l.value.from||0)+" - "+n(l.value.to||0)+" dari "+n(l.value.total||0)+" data ",1),t("ul",ut,[t("li",{class:g(["page-item",{disabled:l.value.current_page===1}])},[t("a",{href:"#",class:"page-link",onClick:e[4]||(e[4]=V(s=>P(l.value.current_page-1),["prevent"]))},"«")],2),t("li",pt,[t("span",vt," Halaman "+n(l.value.current_page)+" / "+n(l.value.last_page),1)]),t("li",{class:g(["page-item",{disabled:l.value.current_page===l.value.last_page}])},[t("a",{href:"#",class:"page-link",onClick:e[5]||(e[5]=V(s=>P(l.value.current_page+1),["prevent"]))},"»")],2)])])])])])]),t("div",mt,[t("div",ct,[t("div",bt,[t("div",ft,[t("h5",gt,[e[17]||(e[17]=_(" Paper Review ")),(u=i.value)!=null&&u.paper_type?(d(),o("span",{key:0,class:g(["badge text-uppercase ms-2",T(i.value)])},n((m=i.value.paper_type)==null?void 0:m.name),3)):c("",!0)]),e[18]||(e[18]=t("button",{type:"button",class:"close","data-dismiss":"modal"},[t("span",null,"×")],-1))]),i.value?(d(),o("div",_t,[t("div",yt,[t("h5",wt,n(i.value.title),1),t("div",xt,n(i.value.authors.map(s=>s.name).join(", ")),1),t("div",ht,[t("span",null,[e[19]||(e[19]=t("strong",null,"Submitted:",-1)),_(" "+n(j(i.value.submitted_at)),1)]),e[21]||(e[21]=t("span",{class:"mx-2"},"•",-1)),t("span",null,[e[20]||(e[20]=t("strong",null,"Reviewed:",-1)),_(" "+n(j(i.value.reviewed_at)),1)])])]),t("div",kt,[e[22]||(e[22]=t("div",{class:"fw-semibold mb-2"}," Abstract / Case Summary ",-1)),t("div",Rt,n(i.value.abstract),1)]),t("div",St,[e[23]||(e[23]=t("div",{class:"fw-semibold mb-1"},"Submitted File",-1)),t("a",{href:i.value.gdrive_link,target:"_blank",class:"text-primary"}," Preview File ",8,Ct)]),e[28]||(e[28]=t("hr",null,null,-1)),t("div",Pt,[e[25]||(e[25]=t("label",{class:"fw-semibold"}," Review Decision ",-1)),f(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>r.value.status=s),class:"form-control form-control-sm"},e[24]||(e[24]=[t("option",{value:""},"-- Pilih Status --",-1),t("option",{value:"accepted"},"Accepted",-1),t("option",{value:"rejected"},"Rejected",-1)]),512),[[R,r.value.status]])]),r.value.status==="accepted"?(d(),o("div",Tt,[e[27]||(e[27]=t("label",{class:"fw-semibold"}," Final Presentation Status ",-1)),f(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>r.value.final_status=s),class:"form-control form-control-sm"},e[26]||(e[26]=[t("option",{value:""},"-- Pilih Final Status --",-1),t("option",{value:"oral_presentation"},"Oral Presentation",-1),t("option",{value:"poster_presentation"},"Poster Presentation",-1)]),512),[[R,r.value.final_status]])])):c("",!0)])):c("",!0),t("div",jt,[e[30]||(e[30]=t("button",{class:"btn btn-secondary btn-sm","data-dismiss":"modal"}," Batal ",-1)),t("button",{class:"btn btn-success btn-sm",disabled:h.value,onClick:E},[h.value?(d(),o("span",Ft)):c("",!0),e[29]||(e[29]=_(" Simpan Keputusan "))],8,Mt)])])])])],64)}}},$t=z(Vt,[["__scopeId","data-v-5086d39f"]]);export{$t as default};
