import{F as d,G as x,J as P,P as o,Q as i,R as t,ah as _,av as F,ap as w,W as V,a5 as b,aw as D,U as s,T as h,S as M}from"./pinia-BDOwh8JO.js";import{a as U}from"./api-CIOX86af.js";import{S as L}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{e as N}from"./app-D-g1j7c6.js";const R={class:"content"},T={class:"container-fluid"},A={class:"card"},H={class:"card-header"},j={class:"d-flex justify-content-between align-items-center"},G={class:"d-flex align-items-center gap-2"},J={class:"d-flex gap-2"},z={class:"card-body table-responsive p-0"},E={class:"table table-bordered table-hover text-sm mb-0"},I={key:0},Q={key:1},W={class:"text-muted"},Y={class:"badge badge-info"},q={class:"text-center"},K=["onClick"],O={class:"card-footer py-2"},X={class:"d-flex justify-content-between"},Z={class:"text-muted"},tt={class:"pagination pagination-sm m-0"},et={class:"page-item disabled"},at={class:"page-link"},st={class:"modal fade",id:"detailModal"},lt={class:"modal-dialog modal-lg modal-dialog-centered"},nt={key:0,class:"modal-content"},ot={class:"modal-body"},it={class:"table table-sm table-bordered"},vt={__name:"PaymentVerificationHistory",setup(dt){const p=d([]),l=d({}),r=d(10),u=d(""),c=d(""),v=d(!1),g=d(null),m=async(n=1)=>{v.value=!0;try{const e=await U.get("/api/v1/payment-verifications/history",{params:{page:n,per_page:r.value,admin:u.value,date:c.value}});p.value=e.data.data.data,l.value=e.data.data}catch{L.fire({icon:"error",title:"Gagal memuat data"})}finally{v.value=!1}},S=n=>{g.value=n,$("#detailModal").modal("show")},y=n=>{n<1||n>l.value.last_page||m(n)},C=n=>Number(n).toLocaleString("id-ID"),B=n=>{if(!n)return"-";const e=new Date(n),a=f=>String(f).padStart(2,"0");return`${e.getFullYear()}-${a(e.getMonth()+1)}-${a(e.getDate())} ${a(e.getHours())}:${a(e.getMinutes())}:${a(e.getSeconds())}`};return x([u,c],N(()=>m(1),400)),x(r,()=>m(1)),P(m),(n,e)=>(i(),o(b,null,[e[13]||(e[13]=t("section",{class:"content-header"},[t("div",{class:"container-fluid"},[t("h1",{class:"mb-1"},"Verification History"),t("p",{class:"mb-0 text-muted text-sm"}," Riwayat verifikasi pembayaran (berbasis payment) ")])],-1)),t("section",R,[t("div",T,[t("div",A,[t("div",H,[t("div",j,[t("div",G,[e[6]||(e[6]=t("label",{class:"mb-0 text-sm text-muted mr-2"},"Tampilkan",-1)),_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),class:"form-control form-control-sm w-auto"},e[5]||(e[5]=[t("option",{value:10},"10",-1),t("option",{value:25},"25",-1),t("option",{value:50},"50",-1)]),512),[[F,r.value,void 0,{number:!0}]])]),t("div",J,[_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),class:"form-control form-control-sm",placeholder:"Filter admin"},null,512),[[w,u.value]]),_(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),type:"date",class:"form-control form-control-sm"},null,512),[[w,c.value]])])])]),t("div",z,[t("table",E,[e[10]||(e[10]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",null,"#"),t("th",null,"Peserta"),t("th",null,"Bank"),t("th",null,"Amount"),t("th",null,"Jumlah Verifikasi"),t("th",{style:{width:"100px"},class:"text-center"},"Detail")])],-1)),t("tbody",null,[v.value?(i(),o("tr",I,e[7]||(e[7]=[t("td",{colspan:"6",class:"text-center"},"Memuat data...",-1)]))):p.value.length===0?(i(),o("tr",Q,e[8]||(e[8]=[t("td",{colspan:"6",class:"text-center text-muted"}," Belum ada riwayat verifikasi ",-1)]))):V("",!0),(i(!0),o(b,null,D(p.value,(a,f)=>{var k;return i(),o("tr",{key:a.id},[t("td",null,s(f+1+(l.value.current_page-1)*l.value.per_page),1),t("td",null,[t("strong",null,s(a.registration.participant.full_name),1),e[9]||(e[9]=t("br",null,null,-1)),t("small",W,s(a.registration.participant.email),1)]),t("td",null,s(((k=a.registration.bank)==null?void 0:k.name)||"-"),1),t("td",null,"Rp "+s(C(a.amount)),1),t("td",null,[t("span",Y,s(a.verifications.length)+"x ",1)]),t("td",q,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:rt=>S(a)}," Lihat ",8,K)])])}),128))])])]),t("div",O,[t("div",X,[t("small",Z,s(l.value.from||0)+" – "+s(l.value.to||0)+" dari "+s(l.value.total||0),1),t("ul",tt,[t("li",{class:h(["page-item",{disabled:l.value.current_page===1}])},[t("a",{href:"#",class:"page-link",onClick:e[3]||(e[3]=M(a=>y(l.value.current_page-1),["prevent"]))},"«")],2),t("li",et,[t("span",at,s(l.value.current_page)+" / "+s(l.value.last_page),1)]),t("li",{class:h(["page-item",{disabled:l.value.current_page===l.value.last_page}])},[t("a",{href:"#",class:"page-link",onClick:e[4]||(e[4]=M(a=>y(l.value.current_page+1),["prevent"]))},"»")],2)])])])])])]),t("div",st,[t("div",lt,[g.value?(i(),o("div",nt,[e[12]||(e[12]=t("div",{class:"modal-header"},[t("h5",{class:"mb-0"},"Riwayat Verifikasi"),t("button",{class:"close","data-dismiss":"modal"},"×")],-1)),t("div",ot,[t("table",it,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"Action"),t("th",null,"Verified By"),t("th",null,"Verified At"),t("th",null,"Notes")])],-1)),t("tbody",null,[(i(!0),o(b,null,D(g.value.verifications,a=>(i(),o("tr",{key:a.id},[t("td",null,[t("span",{class:h(["badge",a.action==="approve"?"badge-success":"badge-danger"])},s(a.action.toUpperCase()),3)]),t("td",null,s(a.verified_by.name),1),t("td",null,s(B(a.verified_at)),1),t("td",null,s(a.notes||"-"),1)]))),128))])])])])):V("",!0)])])],64))}};export{vt as default};
