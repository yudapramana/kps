import{A as h,z as R,x as $,V as N,B as l,C as t,D as e,I as u,G as a,W as j,S as f,aB as k,aj as A,U as r,ay as m,F as z,J as i,K as x,a as F}from"./AuthUserStore-67h2FHdL.js";import{h as p,a as D,b as U}from"./helper-D4kaxrhs.js";import{u as K,a as T}from"./LoadingStore-CLdtPdNn.js";import"./sweetalert2.esm.all-9Qm2jZ7z.js";import{a as H,u as O}from"./app-CZBZEz52.js";const W={class:"content-header"},G={class:"container-fluid"},J={class:"row mb-2"},q={key:0,class:"col-sm-6"},Q={class:"content"},X={class:"container-fluid"},Z={class:"row"},ee={class:"col-12"},se={class:"card"},te={class:"card-body"},le={class:"row"},oe={class:"col-6"},ae={class:"form-group"},ie=["value"],ne={key:0,class:"col-6"},de={class:"form-group"},re=["placeholder"],ue=["value"],ce={key:1,class:"col-6"},me={class:"form-group"},_e=["value"],ve={key:2,class:"col-12"},he={class:"form-group"},pe=["placeholder"],ge=["value"],ye={key:3,class:"col-12"},be={class:"form-group"},fe=["placeholder"],ke=["value"],xe={class:"col-6"},Me=["disabled"],Se={key:0,class:"spinner-border spinner-border-sm mr-2",role:"status"},Ye={key:1},De={class:"col-6"},we=["disabled"],Ie={key:0,class:"spinner-border spinner-border-sm mr-2",role:"status"},Le={key:1},Pe={key:0,class:"timeline"},ze={key:0,class:"time-label"},Ue={class:"bg-primary badge badge-primary badge-sm"},Be={class:"timeline-item"},Ve={class:"time"},Ee={class:"timeline-header",style:{"font-size":"smaller","line-height":"1 !important"}},Ce={class:"time"},Re={class:"timeline-body",style:{"font-size":"small","line-height":"1 !important"}},$e={style:{"font-size":"smaller"}},Ne={style:{"text-align":"right"}},je={style:{"font-size":"smaller",width:"100%"}},Ae=["href"],Fe={class:"bg-primary badge badge-primary badge-sm"},Ke={key:1,class:"text-center"},Te={key:1,class:"card"},He={class:"card-body"},Oe={class:"table-responsive overlay-wrapper",id:"example-table"},We={key:0,class:"overlay"},Ge={class:"table table-bordered"},Je={key:0},qe=["rowspan"],Qe={class:"text-center"},Xe={class:"s"},Ze={class:"text-muted m-0 p-0",style:{"font-size":"small !important"}},es={class:"s text-center"},ss={class:"s"},ts={class:"s"},ls={key:1},os={key:3},as=["src"],ms={__name:"Orgreports",setup(is){const M=H(),g=h(!1),S=h(!1),c=h(!1),Y=h("Pilih Item"),B=K(),_=R(),n=O(),v=h({data:[]}),y=$("SettingStore:mySelected",h("")),V=h([{text:p().subtract(2,"months").format("MMMM  YYYY"),id:p().subtract(2,"months").format("YYYY-MM")},{text:p().subtract(1,"months").format("MMMM  YYYY"),id:p().subtract(1,"months").format("YYYY-MM")},{text:p().format("MMMM  YYYY"),id:p().format("YYYY-MM")}]),w=(I=1)=>{c.value=!0,F.get(`/api/reports?monthyear=${y.value}&page=${I}&user_id=${n.userId}`).then(s=>{console.log(s.data),v.value=s.data,c.value=!1,g.value=!0,S.value=!1,c.value=!1}).catch(s=>{console.log(s.response.data),s.response&&s.response.status===401?window.location.href="/login":console.error("Terjadi kesalahan:",s)})},E=()=>{c.value=!0,g.value=!1,S.value=!0,setTimeout(function(){c.value=!1},2e3)};return N(()=>{n.getOrgList(),_.user.role=="ADMIN"&&n.getUserListbyOrgID(_.user.org_id)}),(I,s)=>{var L,P;return t(),l(r,null,[e("div",W,[e("div",G,[e("div",J,[s[7]||(s[7]=e("div",{class:"col-sm-6"},[e("h1",{class:"m-0"},"LCHK Satker")],-1)),a(M).isMobile?u("",!0):(t(),l("div",q,s[6]||(s[6]=[e("ol",{class:"breadcrumb float-sm-right"},[e("li",{class:"breadcrumb-item"},[e("a",{href:"#"},"Home")]),e("li",{class:"breadcrumb-item active"},"LCKH Satker")],-1)])))])])]),e("div",Q,[e("div",X,[e("div",Z,[e("div",ee,[e("div",se,[e("div",te,[e("div",le,[e("div",oe,[e("div",ae,[s[8]||(s[8]=e("label",{for:"mont",style:{"font-size":"small"}},"Bulan",-1)),f(e("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>A(y)?y.value=o:null),class:"custom-select rounded-0"},[(t(!0),l(r,null,m(V.value,o=>(t(),l("option",{value:o.id,key:o.id},i(o.text),9,ie))),128))],512),[[k,a(y)]])])]),a(_).user.role=="SUPERADMIN"||a(_).user.role=="REVIEWER"?(t(),l("div",ne,[e("div",de,[s[9]||(s[9]=e("label",{for:"organization_id",style:{"font-size":"small"}},"Satuan Kerja",-1)),f(e("select",{"onUpdate:modelValue":s[1]||(s[1]=o=>a(n).orgId=o),class:"custom-select rounded-0",placeholder:Y.value,onChange:s[2]||(s[2]=o=>a(n).getUserList(a(n).orgId)),onSelect:s[3]||(s[3]=o=>a(n).getUserList(a(n).orgId))},[(t(!0),l(r,null,m(a(n).orgList,o=>(t(),l("option",{value:o.id,key:o.id},i(o.text),9,ue))),128))],40,re),[[k,a(n).orgId]])])])):(t(),l("div",ce,[e("div",me,[s[10]||(s[10]=e("label",{for:"organization_id",style:{"font-size":"small"}},"Satuan Kerja",-1)),e("input",{type:"text",class:"form-control",disabled:"",value:a(_).user.org_name},null,8,_e)])])),a(_).user.role=="SUPERADMIN"||a(_).user.role=="REVIEWER"?(t(),l("div",ve,[e("div",he,[s[11]||(s[11]=e("label",{for:"user_id",style:{"font-size":"small"}},"Pilih Pegawai",-1)),f(e("select",{"onUpdate:modelValue":s[4]||(s[4]=o=>a(n).userId=o),class:"custom-select rounded-0",placeholder:Y.value},[(t(!0),l(r,null,m(a(n).userList,o=>(t(),l("option",{value:o.id,key:o.id},i(o.text),9,ge))),128))],8,pe),[[k,a(n).userId]])])])):(t(),l("div",ye,[e("div",be,[s[12]||(s[12]=e("label",{for:"user_id",style:{"font-size":"small"}},"Pilih Pegawai",-1)),f(e("select",{"onUpdate:modelValue":s[5]||(s[5]=o=>a(n).userId=o),class:"custom-select rounded-0",placeholder:Y.value},[(t(!0),l(r,null,m(a(n).userList,o=>(t(),l("option",{value:o.id,key:o.id},i(o.text),9,ke))),128))],8,fe),[[k,a(n).userId]])])])),e("div",xe,[e("button",{type:"submit",class:"btn btn-primary btn-block",disabled:c.value,onClick:z(w,["prevent"])},[c.value?(t(),l("div",Se,s[13]||(s[13]=[e("span",{class:"sr-only"},"Loading...",-1)]))):(t(),l("span",Ye,"Preview Data"))],8,Me)]),e("div",De,[e("button",{type:"submit",class:"btn btn-warning btn-block",disabled:c.value,onClick:z(E,["prevent"])},[c.value?(t(),l("div",Ie,s[14]||(s[14]=[e("span",{class:"sr-only"},"Loading...",-1)]))):(t(),l("span",Le,"Preview PDF"))],8,we)])])])]),g.value&&a(M).isMobile?(t(),l("div",Pe,[s[18]||(s[18]=e("hr",null,null,-1)),v.value.data.length>0?(t(!0),l(r,{key:0},m(v.value.data,(o,C)=>(t(),l(r,null,[o.works.length>0?(t(!0),l(r,{key:0},m(o.works,(d,b)=>(t(),l(r,{key:d.id},[b===0?(t(),l("div",ze,[e("span",Ue,i(a(D)(o.date)),1)])):u("",!0),e("div",null,[e("div",Be,[e("span",Ve," ["+i(d.volume)+" "+i(d.unit)+"] ",1),e("h3",Ee,[e("span",Ce,i(a(D)(o.date)),1)]),e("div",Re,[x(i(d.work_name),1),s[16]||(s[16]=e("br",null,null,-1)),e("span",$e,i(d.work_detail),1),s[17]||(s[17]=e("br",null,null,-1)),e("div",Ne,[e("span",je,[s[15]||(s[15]=x(" Bukti Dukung ")),d.evidence_url?(t(),l("a",{key:0,target:"blank",href:d.evidence_url??"#"}," [ "+i(d.evidence)+" ]",9,Ae)):(t(),l(r,{key:1},[x(" [ "+i(d.evidence)+" ] ",1)],64))])])])])])],64))),128)):(t(),l(r,{key:1},[(t(),l("div",{class:"time-label",key:o.id},[e("span",Fe,i(a(D)(o.date)),1)])),(t(),l("div",{key:o.id,class:"text-center"}," .: Belum ada Data :. "))],64))],64))),256)):(t(),l("div",Ke," .: Belum ada data :. "))])):u("",!0),g.value&&!a(M).isMobile?(t(),l("div",Te,[e("div",He,[e("div",Oe,[a(B).isLoading?(t(),l("div",We,s[19]||(s[19]=[e("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1),e("div",{class:"text-bold pt-2"},"Loading...",-1)]))):u("",!0),e("table",Ge,[s[24]||(s[24]=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Tanggal"),e("th",{scope:"col",class:"text-center"},"#"),e("th",{scope:"col",width:"50%"},"Pekerjaan"),e("th",{scope:"col",class:"text-right"},"Volume"),e("th",{scope:"col"},"Eviden")])],-1)),((L=v.value.data)==null?void 0:L.length)>0?(t(),l("tbody",Je,[(t(!0),l(r,null,m(v.value.data,(o,C)=>(t(),l(r,null,[o.works.length>0?(t(!0),l(r,{key:0},m(o.works,(d,b)=>(t(),l("tr",{key:d.id},[b===0?(t(),l("td",{key:0,rowspan:o.works.length,class:"s",style:{"white-space":"pre"}},i(a(U)(o.date)),9,qe)):u("",!0),e("td",Qe,i(b+1),1),e("td",Xe,[x(i(d.work_name)+" ",1),s[20]||(s[20]=e("br",null,null,-1)),e("p",Ze,i(d.work_detail),1)]),e("td",es,i(d.volume)+"Â "+i(d.unit),1),e("td",ss,i(d.evidence),1)]))),128)):(t(),l("tr",{key:o.id},[e("td",ts,i(a(U)(o.date)),1),s[21]||(s[21]=e("td",{class:"s text-center"},null,-1)),s[22]||(s[22]=e("td",{colspan:"7",class:"text-center"},"Belum ada data...",-1))]))],64))),256))])):u("",!0),((P=v.value.data)==null?void 0:P.length)===0?(t(),l("tbody",ls,s[23]||(s[23]=[e("tr",null,[e("td",{colspan:"7",class:"text-center"},"Tidak ada hasil, silahkan pilih bulan... ")],-1)]))):u("",!0)])])])])):u("",!0),g.value?(t(),j(a(T),{key:2,data:v.value,onPaginationChangePage:w,limit:1,keepLength:!0,style:{"margin-bottom":"100px"}},null,8,["data"])):u("",!0),S.value?(t(),l("div",os,[e("embed",{src:`/preview-lckb/${a(y)}/${a(n).userId}`,width:"100%",height:"600",type:"application/pdf"},null,8,as)])):u("",!0)])])])])],64)}}};export{ms as default};
