import{F as i,G as V,J as L,P as r,Q as d,R as e,ah as u,av as S,ap as p,W as j,a5 as U,aw as E,U as n,T as M,S as C,Z as R,au as Y}from"./pinia-BDOwh8JO.js";import{b as v,e as z}from"./app-qojnDOIY.js";import{S as f}from"./sweetalert2.esm.all-9Qm2jZ7z.js";const A={class:"content"},H={class:"container-fluid"},I={class:"card"},J={class:"card-header"},K={class:"d-flex justify-content-between align-items-center w-100"},Q={class:"card-body table-responsive p-0"},W={class:"table table-bordered table-hover text-sm mb-0"},Z={key:0},O={key:1},X={class:"text-center"},ee={class:"text-center"},se={class:"btn-group btn-group-sm"},te=["onClick"],ae=["onClick"],le={class:"card-footer clearfix py-2"},oe={class:"d-flex justify-content-between align-items-center"},ne={class:"text-muted text-sm"},ie={class:"pagination pagination-sm m-0"},re={class:"page-item disabled"},de={class:"page-link"},ue={class:"modal fade",id:"userModal"},me={class:"modal-dialog modal-lg"},ce={class:"modal-content"},pe={class:"modal-header py-2"},ve={class:"modal-title"},fe={class:"modal-body"},ge={class:"row"},be={class:"col-md-6"},_e={class:"form-group"},he={class:"form-group"},xe={class:"form-group"},we={class:"col-md-6"},ye={class:"form-group"},ke=["value"],Ue={class:"form-group"},Me=["required"],Ce={key:0,class:"text-muted"},Te={class:"form-group"},Be={class:"text-right"},Ve=["disabled"],Re={__name:"UserList",setup($e){const x=f.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),w=i([]),T=i([]),l=i({}),g=i(""),b=i(10),y=i(!1),m=i(!1),k=i(!1),a=i({id:null,name:"",email:"",username:"",password:"",role_id:"",can_multiple_role:!1}),c=async(o=1)=>{y.value=!0;try{const s=await v.get("/api/v1/users",{params:{page:o,per_page:b.value,search:g.value}});w.value=s.data.data.data,l.value=s.data.data}catch{f.fire({icon:"error",title:"Gagal memuat data user"})}finally{y.value=!1}},P=async()=>{const o=await v.get("/api/v1/roles",{params:{simple:!0}});console.log(o),T.value=o.data,console.log("apasih isi roles")},q=()=>{m.value=!1,a.value={id:null,name:"",email:"",username:"",password:"",role_id:"",can_multiple_role:!1},$("#userModal").modal("show")},N=o=>{m.value=!0,a.value={...o,password:""},$("#userModal").modal("show")},D=async()=>{var o,s;k.value=!0;try{m.value?(await v.put(`/api/v1/users/${a.value.id}`,a.value),x.fire({icon:"success",title:"User berhasil diperbarui"})):(await v.post("/api/v1/users",a.value),x.fire({icon:"success",title:"User berhasil ditambahkan"})),$("#userModal").modal("hide"),c(l.value.current_page)}catch(t){f.fire({icon:"error",title:"Gagal menyimpan user",text:((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.message)||"Terjadi kesalahan sistem"})}finally{k.value=!1}},F=async o=>{var t,_;if((await f.fire({title:"Yakin ingin menghapus?",text:`User "${o.name}" akan dihapus permanen`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{await v.delete(`/api/v1/users/${o.id}`),x.fire({icon:"success",title:"User berhasil dihapus"}),c(l.value.current_page)}catch(h){f.fire({icon:"error",title:"Gagal menghapus user",text:((_=(t=h.response)==null?void 0:t.data)==null?void 0:_.message)||"Terjadi kesalahan sistem"})}},B=o=>c(o);return V(g,z(()=>c(1),400)),V(b,()=>c(1)),L(()=>{c(),P()}),(o,s)=>(d(),r(U,null,[e("section",{class:"content-header"},[e("div",{class:"container-fluid"},[e("div",{class:"d-flex justify-content-between align-items-center"},[s[10]||(s[10]=e("div",null,[e("h1",{class:"mb-1"},"Master Users"),e("p",{class:"mb-0 text-muted text-sm"}," Manajemen data pengguna sistem. ")],-1)),e("button",{class:"btn btn-primary btn-sm",onClick:q}," + Tambah User ")])])]),e("section",A,[e("div",H,[e("div",I,[e("div",J,[e("div",K,[e("div",null,[s[12]||(s[12]=e("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),u(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t),class:"form-control form-control-sm d-inline-block w-auto"},s[11]||(s[11]=[e("option",{value:10},"10",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1)]),512),[[S,b.value,void 0,{number:!0}]]),s[13]||(s[13]=e("span",{class:"text-sm text-muted ml-1"},"Entri",-1))]),u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>g.value=t),type:"text",class:"form-control form-control-sm w-auto",style:{"min-width":"220px"},placeholder:"Cari nama / email / username..."},null,512),[[p,g.value]])])]),e("div",Q,[e("table",W,[s[18]||(s[18]=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{style:{width:"40px"}},"#"),e("th",null,"Nama"),e("th",null,"Email"),e("th",null,"Username"),e("th",{style:{width:"120px"}},"Role"),e("th",{style:{width:"90px"},class:"text-center"},"Multi Role"),e("th",{style:{width:"110px"},class:"text-center"},"Aksi")])],-1)),e("tbody",null,[y.value?(d(),r("tr",Z,s[14]||(s[14]=[e("td",{colspan:"7",class:"text-center"},"Memuat data...",-1)]))):w.value.length===0?(d(),r("tr",O,s[15]||(s[15]=[e("td",{colspan:"7",class:"text-center text-muted"}," Belum ada user. ",-1)]))):j("",!0),(d(!0),r(U,null,E(w.value,(t,_)=>{var h;return d(),r("tr",{key:t.id},[e("td",null,n(_+1+(l.value.current_page-1)*l.value.per_page),1),e("td",null,[e("strong",null,n(t.name),1)]),e("td",null,n(t.email),1),e("td",null,n(t.username??"-"),1),e("td",null,n((h=t.role)==null?void 0:h.name),1),e("td",X,[e("span",{class:M(["badge",t.can_multiple_role?"badge-success":"badge-secondary"])},n(t.can_multiple_role?"Ya":"Tidak"),3)]),e("td",ee,[e("div",se,[e("button",{class:"btn btn-warning",onClick:G=>N(t)},s[16]||(s[16]=[e("i",{class:"fas fa-edit"},null,-1)]),8,te),e("button",{class:"btn btn-danger",onClick:G=>F(t)},s[17]||(s[17]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ae)])])])}),128))])])]),e("div",le,[e("div",oe,[e("div",ne," Menampilkan "+n(l.value.from||0)+" - "+n(l.value.to||0)+" dari "+n(l.value.total||0)+" data ",1),e("ul",ie,[e("li",{class:M(["page-item",{disabled:l.value.current_page===1}])},[e("a",{href:"#",class:"page-link",onClick:s[2]||(s[2]=C(t=>B(l.value.current_page-1),["prevent"]))},"«")],2),e("li",re,[e("span",de," Halaman "+n(l.value.current_page)+" / "+n(l.value.last_page),1)]),e("li",{class:M(["page-item",{disabled:l.value.current_page===l.value.last_page}])},[e("a",{href:"#",class:"page-link",onClick:s[3]||(s[3]=C(t=>B(l.value.current_page+1),["prevent"]))},"»")],2)])])])])]),e("div",ue,[e("div",me,[e("div",ce,[e("div",pe,[e("h5",ve,n(m.value?"Edit User":"Tambah User"),1),s[19]||(s[19]=e("button",{type:"button",class:"close","data-dismiss":"modal"},[e("span",null,"×")],-1))]),e("div",fe,[e("form",{onSubmit:C(D,["prevent"])},[e("div",ge,[e("div",be,[e("div",_e,[s[20]||(s[20]=e("label",null,"Nama",-1)),u(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>a.value.name=t),class:"form-control form-control-sm",required:""},null,512),[[p,a.value.name]])]),e("div",he,[s[21]||(s[21]=e("label",null,"Email",-1)),u(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>a.value.email=t),type:"email",class:"form-control form-control-sm",required:""},null,512),[[p,a.value.email]])]),e("div",xe,[s[22]||(s[22]=e("label",null,"Username",-1)),u(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>a.value.username=t),class:"form-control form-control-sm"},null,512),[[p,a.value.username]])])]),e("div",we,[e("div",ye,[s[24]||(s[24]=e("label",null,"Role",-1)),u(e("select",{"onUpdate:modelValue":s[7]||(s[7]=t=>a.value.role_id=t),class:"form-control form-control-sm",required:""},[s[23]||(s[23]=e("option",{value:""},"-- Pilih Role --",-1)),(d(!0),r(U,null,E(T.value,t=>(d(),r("option",{key:t.id,value:t.id},n(t.name),9,ke))),128))],512),[[S,a.value.role_id]])]),e("div",Ue,[s[25]||(s[25]=e("label",null,"Password",-1)),u(e("input",{"onUpdate:modelValue":s[8]||(s[8]=t=>a.value.password=t),type:"password",class:"form-control form-control-sm",required:!m.value},null,8,Me),[[p,a.value.password]]),m.value?(d(),r("small",Ce," Kosongkan jika tidak ingin mengubah password. ")):j("",!0)]),e("div",Te,[e("label",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[9]||(s[9]=t=>a.value.can_multiple_role=t)},null,512),[[Y,a.value.can_multiple_role]]),s[26]||(s[26]=R(" Bisa Multi Role "))])])])]),e("div",Be,[e("button",{class:"btn btn-primary btn-sm",disabled:k.value},s[27]||(s[27]=[e("i",{class:"fas fa-save mr-1"},null,-1),R(" Simpan ")]),8,Ve)])],32)])])])])])],64))}};export{Re as default};
