import{B as q,F as m,G as M,J as R,P as v,Q as f,R as t,ah as n,Z as D,av as w,a5 as x,aw as j,ap as b,W as K,U as r,T as A,S as E,au as W}from"./pinia-BDOwh8JO.js";import{u as Z,b as y}from"./app-D-g1j7c6.js";import{S as c}from"./sweetalert2.esm.all-9Qm2jZ7z.js";const O={class:"content"},X={class:"container-fluid"},tt={class:"card"},et={class:"card-header"},at={class:"d-flex justify-content-between align-items-center w-100"},st=["value"],ot={class:"card-body p-0"},lt={class:"table table-bordered table-hover text-sm mb-0"},it={class:"text-muted"},nt=["onClick"],rt=["onClick"],dt=["onClick"],ut={key:0},ct={colspan:"6",class:"bg-light"},pt={class:"pl-3"},mt=["onUpdate:modelValue","onChange"],vt=["onUpdate:modelValue","onBlur"],ft=["onUpdate:modelValue","onChange"],bt=["onClick"],gt={class:"d-flex align-items-center mt-2"},yt=["onUpdate:modelValue"],ht=["onUpdate:modelValue"],_t=["onUpdate:modelValue"],xt=["onClick"],kt={key:0},wt={class:"card-footer clearfix py-2"},Ct={class:"d-flex justify-content-between align-items-center"},Tt={class:"text-muted text-sm"},Vt={class:"pagination pagination-sm m-0"},Ut={class:"page-item disabled"},$t={class:"page-link"},Bt={class:"modal fade",id:"activityModal"},Mt={class:"modal-dialog modal-lg"},jt={class:"modal-content"},At={class:"modal-header py-2"},St={class:"modal-body"},Dt={class:"row"},Et={class:"col-md-6"},Gt=["value"],Pt={class:"col-md-6"},qt={class:"text-sm"},Ht={__name:"ActivityList",setup(Kt){const h=c.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),F=Z(),J=q(()=>F.eventData||null),k=q(()=>{var s;return((s=J.value)==null?void 0:s.id)||null}),C=m([]),T=m(""),V=m(10),U=m(!1),_=m({}),g=m({}),B=m(""),l=m({current_page:1,last_page:1,per_page:10,from:0,to:0,total:0}),G=["plenary","symposium","workshop","jeopardy","poster"],i=m({id:null,event_id:"",category:"",code:"",title:"",description:"",is_paid:!0,quota:null}),u=async(s=1)=>{if(k.value)try{const e=await y.get("/api/v1/activities",{params:{page:s,per_page:V.value,search:T.value,event_id:k.value,category:B.value}});C.value=e.data.data.data,l.value=e.data.data,C.value.forEach(a=>{_.value[a.id]=_.value[a.id]??!1,g.value[a.id]={title:"",type:"lecture",order:a.topics.length+1}})}catch{c.fire({icon:"error",title:"Gagal memuat activity"})}},P=s=>{s<1||s>l.value.last_page||u(s)},L=()=>{U.value=!1,i.value={event_id:k.value,is_paid:!0},$("#activityModal").modal("show")},H=s=>{U.value=!0,i.value={...s},$("#activityModal").modal("show")},N=async()=>{var s,e;try{U.value?(await y.put(`/api/v1/activities/${i.value.id}`,i.value),h.fire({icon:"success",title:"Activity berhasil diperbarui"})):(await y.post("/api/v1/activities",{...i.value,event_id:k.value}),h.fire({icon:"success",title:"Activity berhasil ditambahkan"})),$("#activityModal").modal("hide"),u(l.value.current_page)}catch(a){c.fire({icon:"error",title:"Gagal menyimpan activity",text:((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Terjadi kesalahan sistem"})}},Q=async s=>{var a,d;if((await c.fire({title:"Hapus activity?",text:`Activity "${s.title}" akan dihapus`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{await y.delete(`/api/v1/activities/${s.id}`),h.fire({icon:"success",title:"Activity berhasil dihapus"}),u(l.value.current_page)}catch(o){c.fire({icon:"error",title:"Gagal menghapus activity",text:((d=(a=o.response)==null?void 0:a.data)==null?void 0:d.message)||"Terjadi kesalahan sistem"})}},Y=s=>{_.value[s]=!_.value[s]},z=async s=>{var a,d;const e=g.value[s];if(!e.title){c.fire({icon:"warning",title:"Judul topik wajib diisi"});return}try{await y.post("/api/v1/activity-topics",{...e,activity_id:s}),h.fire({icon:"success",title:"Topik berhasil ditambahkan"}),u(l.value.current_page)}catch(o){c.fire({icon:"error",title:"Gagal menambah topik",text:((d=(a=o.response)==null?void 0:a.data)==null?void 0:d.message)||"Terjadi kesalahan sistem"})}},S=async s=>{var e,a;try{await y.put(`/api/v1/activity-topics/${s.id}`,s),h.fire({icon:"success",title:"Topik diperbarui"})}catch(d){c.fire({icon:"error",title:"Gagal memperbarui topik",text:((a=(e=d.response)==null?void 0:e.data)==null?void 0:a.message)||"Terjadi kesalahan sistem"})}},I=async s=>{var a,d;if((await c.fire({title:"Hapus topik?",text:`Topik "${s.title}" akan dihapus`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{await y.delete(`/api/v1/activity-topics/${s.id}`),h.fire({icon:"success",title:"Topik berhasil dihapus"}),u(l.value.current_page)}catch(o){c.fire({icon:"error",title:"Gagal menghapus topik",text:((d=(a=o.response)==null?void 0:a.data)==null?void 0:d.message)||"Terjadi kesalahan sistem"})}};return M(T,()=>u(1)),M(V,()=>u(1)),M(k,()=>u(1)),M(B,()=>u(1)),R(()=>{u()}),(s,e)=>(f(),v(x,null,[t("section",{class:"content-header"},[t("div",{class:"container-fluid"},[t("div",{class:"d-flex justify-content-between align-items-center"},[e[11]||(e[11]=t("div",null,[t("h1",{class:"mb-1"},"Activities"),t("p",{class:"mb-0 text-muted text-sm"}," Manajemen Kegiatan dari Event ")],-1)),t("button",{class:"btn btn-primary btn-sm",onClick:L}," + Tambah Activity ")])])]),t("section",O,[t("div",X,[t("div",tt,[t("div",et,[t("div",at,[t("div",null,[e[14]||(e[14]=t("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),n(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),class:"form-control form-control-sm d-inline-block w-auto"},e[12]||(e[12]=[t("option",{value:10},"10",-1),t("option",{value:25},"25",-1),t("option",{value:50},"50",-1)]),512),[[w,V.value,void 0,{number:!0}]]),e[15]||(e[15]=t("span",{class:"text-sm text-muted ml-1 mr-2"},"Entri",-1)),e[16]||(e[16]=D(" | ")),n(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>B.value=a),class:"form-control form-control-sm d-inline-block w-auto ml-2",style:{"min-width":"160px"}},[e[13]||(e[13]=t("option",{value:""},"Semua Kategori",-1)),(f(),v(x,null,j(G,a=>t("option",{key:a,value:a},r(a),9,st)),64))],512),[[w,B.value]])]),n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>T.value=a),type:"text",class:"form-control form-control-sm w-auto",style:{"min-width":"220px"},placeholder:"Cari judul / kode..."},null,512),[[b,T.value]])])]),t("div",ot,[t("table",lt,[e[25]||(e[25]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",null,"Activity"),t("th",{style:{width:"120px"}},"Kategori"),t("th",{style:{width:"80px"}},"Quota"),t("th",{style:{width:"80px"}},"Paid"),t("th",{style:{width:"220px"}},"Aksi")])],-1)),t("tbody",null,[(f(!0),v(x,null,j(C.value,(a,d)=>(f(),v(x,{key:a.id},[t("tr",null,[t("td",null,r(d+1+(l.value.current_page-1)*l.value.per_page),1),t("td",null,[t("strong",null,r(a.title),1),e[17]||(e[17]=t("br",null,null,-1)),t("small",it,r(a.code||"-"),1)]),t("td",null,r(a.category),1),t("td",null,r(a.quota??"-"),1),t("td",null,[t("span",{class:A(["badge",a.is_paid?"badge-success":"badge-secondary"])},r(a.is_paid?"Paid":"Free"),3)]),t("td",null,[t("button",{class:"btn btn-outline-info btn-xs mr-1",onClick:o=>Y(a.id)},[t("i",{class:A(["fas",_.value[a.id]?"fa-chevron-up":"fa-chevron-down"])},null,2),D(" Topics ("+r(a.topics.length)+") ",1)],8,nt),t("button",{class:"btn btn-warning btn-xs mr-1",onClick:o=>H(a)},e[18]||(e[18]=[t("i",{class:"fas fa-edit"},null,-1)]),8,rt),t("button",{class:"btn btn-danger btn-xs",onClick:o=>Q(a)},e[19]||(e[19]=[t("i",{class:"fas fa-trash"},null,-1)]),8,dt)])]),_.value[a.id]?(f(),v("tr",ut,[t("td",ct,[t("div",pt,[(f(!0),v(x,null,j(a.topics,o=>(f(),v("div",{key:o.id,class:"d-flex align-items-center mb-1"},[n(t("input",{"onUpdate:modelValue":p=>o.order=p,type:"number",class:"form-control form-control-sm mr-1",style:{width:"60px"},onChange:p=>S(o)},null,40,mt),[[b,o.order,void 0,{number:!0}]]),n(t("input",{"onUpdate:modelValue":p=>o.title=p,class:"form-control form-control-sm mr-1",onBlur:p=>S(o)},null,40,vt),[[b,o.title]]),n(t("select",{"onUpdate:modelValue":p=>o.type=p,class:"form-control form-control-sm mr-1",style:{width:"140px"},onChange:p=>S(o)},e[20]||(e[20]=[t("option",{value:"lecture"},"Lecture",-1),t("option",{value:"case"},"Case",-1),t("option",{value:"video"},"Video",-1),t("option",{value:"discussion"},"Discussion",-1)]),40,ft),[[w,o.type]]),t("button",{class:"btn btn-danger btn-xs",onClick:p=>I(o)},e[21]||(e[21]=[t("i",{class:"fas fa-times"},null,-1)]),8,bt)]))),128)),t("div",gt,[n(t("input",{"onUpdate:modelValue":o=>g.value[a.id].order=o,type:"number",class:"form-control form-control-sm mr-1",style:{width:"60px"}},null,8,yt),[[b,g.value[a.id].order,void 0,{number:!0}]]),n(t("input",{"onUpdate:modelValue":o=>g.value[a.id].title=o,class:"form-control form-control-sm mr-1",placeholder:"Judul topik"},null,8,ht),[[b,g.value[a.id].title]]),n(t("select",{"onUpdate:modelValue":o=>g.value[a.id].type=o,class:"form-control form-control-sm mr-1",style:{width:"140px"}},e[22]||(e[22]=[t("option",{value:"lecture"},"Lecture",-1),t("option",{value:"case"},"Case",-1),t("option",{value:"video"},"Video",-1),t("option",{value:"discussion"},"Discussion",-1)]),8,_t),[[w,g.value[a.id].type]]),t("button",{class:"btn btn-success btn-xs",onClick:o=>z(a.id)},e[23]||(e[23]=[t("i",{class:"fas fa-plus"},null,-1)]),8,xt)])])])])):K("",!0)],64))),128)),C.value.length===0?(f(),v("tr",kt,e[24]||(e[24]=[t("td",{colspan:"6",class:"text-center text-muted"}," Belum ada activity. ",-1)]))):K("",!0)])])]),t("div",wt,[t("div",Ct,[t("div",Tt," Menampilkan "+r(l.value.from||0)+" – "+r(l.value.to||0)+" dari "+r(l.value.total||0)+" data ",1),t("ul",Vt,[t("li",{class:A(["page-item",{disabled:l.value.current_page===1}])},[t("a",{href:"#",class:"page-link",onClick:e[3]||(e[3]=E(a=>P(l.value.current_page-1),["prevent"]))},"«")],2),t("li",Ut,[t("span",$t," Halaman "+r(l.value.current_page)+" / "+r(l.value.last_page),1)]),t("li",{class:A(["page-item",{disabled:l.value.current_page===l.value.last_page}])},[t("a",{href:"#",class:"page-link",onClick:e[4]||(e[4]=E(a=>P(l.value.current_page+1),["prevent"]))},"»")],2)])])])])]),t("div",Bt,[t("div",Mt,[t("div",jt,[t("div",At,[t("h5",null,r(U.value?"Edit Activity":"Tambah Activity"),1),e[26]||(e[26]=t("button",{class:"close","data-dismiss":"modal"},"×",-1))]),t("div",St,[t("form",{onSubmit:E(N,["prevent"])},[t("div",Dt,[t("div",Et,[n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>i.value.title=a),class:"form-control form-control-sm mb-2",placeholder:"Judul",required:""},null,512),[[b,i.value.title]]),n(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>i.value.code=a),class:"form-control form-control-sm mb-2",placeholder:"Kode"},null,512),[[b,i.value.code]]),n(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>i.value.category=a),class:"form-control form-control-sm mb-2",required:""},[e[27]||(e[27]=t("option",{value:""},"Kategori",-1)),(f(),v(x,null,j(G,a=>t("option",{key:a,value:a},r(a),9,Gt)),64))],512),[[w,i.value.category]])]),t("div",Pt,[n(t("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>i.value.quota=a),type:"number",class:"form-control form-control-sm mb-2",placeholder:"Quota"},null,512),[[b,i.value.quota,void 0,{number:!0}]]),t("label",qt,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=a=>i.value.is_paid=a)},null,512),[[W,i.value.is_paid]]),e[28]||(e[28]=D(" Paid "))])])]),n(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=a=>i.value.description=a),class:"form-control form-control-sm",placeholder:"Deskripsi"},null,512),[[b,i.value.description]]),e[29]||(e[29]=t("div",{class:"text-right mt-2"},[t("button",{class:"btn btn-primary btn-sm"},"Simpan")],-1))],32)])])])])])],64))}};export{Ht as default};
