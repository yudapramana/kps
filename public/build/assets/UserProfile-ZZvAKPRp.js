import{F as f,A as j,J as F,P as n,Q as r,R as e,W as u,x as l,U as d,as as W,Z as g,S as h,ah as p,ap as c,av as A,a5 as H}from"./pinia-BDOwh8JO.js";import{u as T}from"./toastr-Ct0VgbgP.js";import{d as E,u as J,i as z}from"./app-D-g1j7c6.js";import{u as Q}from"./MasterDataStore-CX9Fqoc8.js";const R={class:"content-header"},Z={class:"container-fluid"},$={class:"row mb-2"},q={key:0,class:"col-sm-6"},G={class:"content"},O={class:"container-fluid"},X={class:"row",style:{"margin-bottom":"100px"}},Y={class:"col-md-3"},ee={class:"card card-primary card-outline"},se={class:"card-body box-profile"},oe={class:"text-center"},te=["src"],ae={class:"profile-username text-center"},le={class:"text-muted text-center text-sm"},ne={class:"col-md-9"},re={class:"card"},ie={class:"card-body"},de={class:"tab-content"},me={class:"tab-pane active",id:"profile"},ue={class:"col-md-6"},pe={key:0,class:"text-danger text-sm"},ce={class:"col-md-6"},fe={key:0,class:"text-danger text-sm"},_e={class:"col-md-6"},be={key:0,class:"text-danger text-sm"},ve={class:"col-md-6"},ge={key:0,class:"text-danger text-sm"},ye={class:"col-md-6"},we={key:0,class:"text-danger text-sm"},he={class:"col-md-6"},xe={key:0,class:"text-danger text-sm"},ke={class:"col-12"},Pe={key:0,type:"button",class:"btn btn-warning btn-sm",disabled:""},Se=["disabled"],Ue={key:0,class:"fa fa-spinner fa-spin me-1"},Ce={key:1,class:"fa fa-save me-1"},Ve={class:"tab-pane",id:"changePassword"},Ke={class:"form-group row"},Me={class:"col-sm-9"},Be={key:0,class:"text-danger text-sm"},Ne={class:"form-group row"},De={class:"col-sm-9"},Ie={key:0,class:"text-danger text-sm"},Le={class:"form-group row"},je={class:"col-sm-9"},Fe={class:"form-group row"},We={class:"offset-sm-3 col-sm-9"},Ae=["disabled"],He={key:0,class:"fa fa-spinner fa-spin mr-1"},Te={key:1,class:"fa fa-save mr-1"},Ze={__name:"UserProfile",setup(Ee){const V=E(),o=J(),K=Q(),y=z();y.setting.maintenance=["1",1,!0,"true","on"].includes(y.setting.maintenance);const _=T(),t=f([]),w=f(""),b=f(!1),v=f(!1),M=window.cloudinary.createUploadWidget({cloud_name:"pesselkemenag",upload_preset:"profile_picture"},(i,s)=>{!i&&s&&s.event==="success"&&(w.value=s.info.secure_url),!i&&s&&s.event=="close"&&I()});function B(){M.open()}const N=()=>{b.value=!0,axios.put("/api/profile",{nip:o.user.employee.nip,full_name:o.user.employee.full_name,date_of_birth:o.user.employee.date_of_birth,gender:o.user.employee.gender,phone_number:o.user.employee.phone_number,email:o.user.employee.email,job_title:o.user.employee.job_title,id_work_unit:o.user.employee.id_work_unit,employment_status:o.user.employee.employment_status,tmt_pangkat:o.user.employee.tmt_pangkat,tmt_jabatan:o.user.employee.tmt_jabatan}).then(i=>{_.success("Profile updated successfully!")}).catch(i=>{i.response&&i.response.status===422&&(t.value=i.response.data.errors)}).finally(()=>{b.value=!1})},D=()=>{o.logout()};f(null);const I=i=>{w.value!=""?axios.post("/api/upload-profile-image",{profile_picture:w.value}).then(s=>{o.getAuthUser(),_.success("Image uploaded successfully!")}):_.error("Image failed to upload!")},m=j({currentPassword:"",password:"",passwordConfirmation:""}),L=()=>{v.value=!0,t.value="",axios.post("/api/change-user-password",m).then(i=>{_.success(i.data.message);for(const s in m)m[s]=""}).catch(i=>{i.response&&i.response.status===422&&(t.value=i.response.data.errors)}).finally(()=>{v.value=!1})};return F(()=>{K.getWorkunitList()}),(i,s)=>{var x,k,P,S,U,C;return r(),n(H,null,[e("div",R,[e("div",Z,[e("div",$,[s[11]||(s[11]=e("div",{class:"col-sm-6"},[e("h1",{class:"m-0"},"Profile")],-1)),l(V).isMobile?u("",!0):(r(),n("div",q,s[10]||(s[10]=[e("ol",{class:"breadcrumb float-sm-right"},[e("li",{class:"breadcrumb-item"},[e("a",{href:"#"},"Home")]),e("li",{class:"breadcrumb-item active"},"Profile")],-1)])))])])]),e("div",G,[e("div",O,[e("div",X,[e("div",Y,[e("div",ee,[e("div",se,[e("div",oe,[e("img",{onClick:B,class:"profile-user-img img-circle",src:l(o).user.avatar,alt:"User profile picture"},null,8,te)]),e("h3",ae,d(l(o).user.employee.full_name),1),e("p",le,d(l(o).user.employee.job_title),1)])])]),e("div",ne,[e("div",re,[s[28]||(s[28]=W('<div class="card-header p-2"><ul class="nav nav-pills"><li class="nav-item"><a class="nav-link active" href="#profile" data-toggle="tab"><i class="fa fa-user mr-1"></i> Edit Profile</a></li><li class="nav-item"><a class="nav-link" href="#changePassword" data-toggle="tab"><i class="fa fa-key mr-1"></i> Change Password</a></li></ul></div>',1)),e("div",ie,[e("div",de,[e("div",me,[s[22]||(s[22]=e("span",{class:"text-warning d-block my-2"},[e("i",{class:"fas fa-exclamation-triangle me-1"}),g(" Harap mengisi nomor HP / WhatsApp sebelum mengisi dokumen. ")],-1)),e("form",{onSubmit:s[6]||(s[6]=h(a=>N(),["prevent"])),class:"row g-3"},[e("div",ue,[s[12]||(s[12]=e("label",{class:"form-label small fw-semibold mb-1"},"NIP (Nomor Induk Pegawai)",-1)),p(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>l(o).user.employee.nip=a),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[c,l(o).user.employee.nip]]),(x=t.value)!=null&&x.nip?(r(),n("span",pe,d(t.value.nip[0]),1)):u("",!0)]),e("div",ce,[s[13]||(s[13]=e("label",{class:"form-label small fw-semibold mb-1"},"Nama Lengkap",-1)),p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>l(o).user.employee.full_name=a),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[c,l(o).user.employee.full_name]]),(k=t.value)!=null&&k.full_name?(r(),n("span",fe,d(t.value.full_name[0]),1)):u("",!0)]),e("div",_e,[s[14]||(s[14]=e("label",{class:"form-label small fw-semibold mb-1"},"Tanggal Lahir",-1)),p(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>l(o).user.employee.date_of_birth=a),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[c,l(o).user.employee.date_of_birth]]),(P=t.value)!=null&&P.date_of_birth?(r(),n("span",be,d(t.value.date_of_birth[0]),1)):u("",!0)]),e("div",ve,[s[16]||(s[16]=e("label",{class:"form-label small fw-semibold mb-1"},"Jenis Kelamin",-1)),p(e("select",{"onUpdate:modelValue":s[3]||(s[3]=a=>l(o).user.employee.gender=a),class:"form-control form-control-sm",disabled:""},s[15]||(s[15]=[e("option",{value:""},"Pilih",-1),e("option",{value:"M"},"Laki-laki",-1),e("option",{value:"F"},"Perempuan",-1)]),512),[[A,l(o).user.employee.gender]]),(S=t.value)!=null&&S.gender?(r(),n("span",ge,d(t.value.gender[0]),1)):u("",!0)]),e("div",ye,[s[17]||(s[17]=e("label",{class:"form-label small fw-semibold mb-1"},"Nomor HP",-1)),p(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>l(o).user.employee.phone_number=a),type:"text",class:"form-control form-control-sm",placeholder:"08xxxx"},null,512),[[c,l(o).user.employee.phone_number]]),(U=t.value)!=null&&U.phone_number?(r(),n("span",we,d(t.value.phone_number[0]),1)):u("",!0)]),e("div",he,[s[18]||(s[18]=e("label",{class:"form-label small fw-semibold mb-1"},"Email",-1)),p(e("input",{"onUpdate:modelValue":s[5]||(s[5]=a=>l(o).user.employee.email=a),type:"email",class:"form-control form-control-sm",readonly:""},null,512),[[c,l(o).user.employee.email]]),(C=t.value)!=null&&C.email?(r(),n("span",xe,d(t.value.email[0]),1)):u("",!0)]),s[21]||(s[21]=e("hr",null,null,-1)),e("div",ke,[s[20]||(s[20]=e("hr",null,null,-1)),l(y).showMaintenanceBadge?(r(),n("button",Pe," Maintenance ")):(r(),n("button",{key:1,type:"submit",class:"btn btn-success btn-sm",disabled:b.value},[b.value?(r(),n("i",Ue)):(r(),n("i",Ce)),s[19]||(s[19]=g(" Simpan Perubahan "))],8,Se))])],32)]),e("div",Ve,[e("form",{onSubmit:h(L,["prevent"]),class:"form-horizontal"},[e("div",Ke,[s[23]||(s[23]=e("label",{for:"currentPassword",class:"col-sm-3 col-form-label"},"Kata Sandi Saat Ini",-1)),e("div",Me,[p(e("input",{"onUpdate:modelValue":s[7]||(s[7]=a=>m.currentPassword=a),type:"password",class:"form-control",id:"currentPassword",placeholder:"Kata Sandi Saat Ini"},null,512),[[c,m.currentPassword]]),t.value&&t.value.current_password?(r(),n("span",Be,d(t.value.current_password[0]),1)):u("",!0)])]),e("div",Ne,[s[24]||(s[24]=e("label",{for:"newPassword",class:"col-sm-3 col-form-label"},"Kata Sandi Baru",-1)),e("div",De,[p(e("input",{"onUpdate:modelValue":s[8]||(s[8]=a=>m.password=a),type:"password",class:"form-control",id:"newPassword",placeholder:"Kata Sandi Baru"},null,512),[[c,m.password]]),t.value&&t.value.password?(r(),n("span",Ie,d(t.value.password[0]),1)):u("",!0)])]),e("div",Le,[s[25]||(s[25]=e("label",{for:"passwordConfirmation",class:"col-sm-3 col-form-label"},"Konfirmasi Kata Sandi Baru",-1)),e("div",je,[p(e("input",{"onUpdate:modelValue":s[9]||(s[9]=a=>m.passwordConfirmation=a),type:"password",class:"form-control",id:"passwordConfirmation",placeholder:"Konfirmasi Kata Sandi Baru"},null,512),[[c,m.passwordConfirmation]])])]),e("div",Fe,[e("div",We,[e("button",{type:"submit",class:"btn btn-success",disabled:v.value},[v.value?(r(),n("i",He)):(r(),n("i",Te)),s[26]||(s[26]=g(" Save Changes "))],8,Ae)])])],32)])])]),e("button",{onClick:h(D,["prevent"]),type:"button",class:"btn btn-danger btn-block"},s[27]||(s[27]=[e("i",{class:"fas fa-sign-out-alt"},null,-1),g(" Logout")]))])])])])])],64)}}};export{Ze as default};
